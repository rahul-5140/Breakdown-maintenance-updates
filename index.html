<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title _msttexthash="1578135" _msthash="73">PRI L&amp;S Parachange/Floating History Sharing Form</title>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            color: #333;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        .header {
            background-color: #4a4a4a;
            color: white;
            padding: 20px;
            text-align: center;
            border-radius: 5px 5px 0 0;
        }
        .tab-container {
            display: flex;
            background-color: #e0e0e0;
        }
        .tab {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            font-weight: bold;
        }
        .tab.active {
            background-color: white;
        }
        .form-container {
            background-color: white;
            padding: 20px;
            border-radius: 0 0 5px 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .form {
            display: none;
        }
        .form.active {
            display: block;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
        .button {
            background-color: #4a4a4a;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            margin-top: 10px;
        }
        .button:hover {
            background-color: #5a5a5a;
        }
        .footer {
            text-align: right;
            padding: 10px;
            font-size: 12px;
            color: #666;
            margin-top: 20px;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: none;
        }
        #copyButton {
            margin-right: 10px;
            background-color: #28a745;
        }
        #shareButton {
            background-color: #4267B2;
            color: white;
        }
        #uploadButton {
            background-color:  #28a745;
            color: white;
        }
        #openButton {
            background-color: #962527;
            color: white;
        }
        .alert-box {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 20px;
            background-color: #333;
            color: white;
            border-radius: 5px;
            z-index: 1000;
            display: none; /* Ï¥àÍ∏∞ÏóêÎäî Ïà®ÍπÄ */
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
        }
        .alert-box.show {
            display: block;
            opacity: 1;
        }
    </style>
    <!-- Ïπ¥Ïπ¥Ïò§ SDK Ï†úÍ±∞ - Web Share API ÏÇ¨Ïö© -->
</head>

<body>
<!-- LANGUAGE TOGGLE (UI ONLY) -->
<div style="display:flex; justify-content:flex-end; gap:10px; margin:10px;">
  <button id="btn-en" onclick="setLang('en')" style="padding:6px 12px;font-weight:bold;">EN</button>
  <button id="btn-kr" onclick="setLang('kr')" style="padding:6px 12px;font-weight:bold;">KR</button>
</div>

    <div class="container">
        <div class="header">
            <h1 _msttexthash="1539499" _msthash="74">PRI L&amp;S Para Change History Floating History Form</h1>
            <p _msttexthash="2415127" _msthash="75">Enter Parameter Change History and Floating &amp; Work History Form</p>
        </div>
        
        <div class="tab-container">
          <div class="tab" onclick="switchTab('parameterForm')" _msttexthash="416078" _msthash="76">Para/IP Change Sharing</div>
          <div class="tab active" onclick="switchTab('troubleForm')" _msttexthash="466635" _msthash="77">Share floating history</div>
        </div>
        
        <div class="form-container">
            <!-- ÌååÎùºÎØ∏ÌÑ∞ Î≥ÄÍ≤Ω Ìèº -->
            <div id="parameterForm" class="form" _mstvisible="0">
            <!-- ÏõêÎûòÍ±∞ div id="parameterForm" class="form active" -->

                <div class="form-group" _mstvisible="1">
                    <label for="para-site" _msttexthash="74659" _msthash="78" _mstvisible="2">0. Site :</label>
                    <select id="para-site" _mstvisible="2">
                        <option value="-" _mstvisible="3">-</option>
                        <option value="WA" _msttexthash="14677" _msthash="79" _mstvisible="3">WA</option>
                        <option value="WA5" _msttexthash="20878" _msthash="80" _mstvisible="3">WA5</option>
                        <option value="UC1" _msttexthash="20436" _msthash="81" _mstvisible="3">UC1</option>
                        <option value="UC2" _msttexthash="20553" _msthash="82" _mstvisible="3">UC2</option>
                        <option value="MI1" _msttexthash="20332" _msthash="83" _mstvisible="3">MI1</option>
                        <option value="MI2" _msttexthash="20449" _msthash="84" _mstvisible="3">MI2</option>
                        <option value="MI3" _msttexthash="20566" _msthash="85" _mstvisible="3">MI3</option>
                        <option value="NSE" _msttexthash="23803" _msthash="86" _mstvisible="3">NSE</option>
                        <option value="L-H" _msttexthash="20020" _msthash="87" _mstvisible="3">L-H</option>
                    </select>
                </div>

                <div class="form-group" _mstvisible="1">
                    <label for="para-machine" _msttexthash="115544" _msthash="88" _mstvisible="2">1. Volume:</label>
                    <select id="para-machine" _mstvisible="2">
                        <option value="-" _mstvisible="3">-</option>


                    </select>
                </div>

                <div class="form-group" _mstvisible="1">
                    <label for="para-process" _msttexthash="161993" _msthash="89" _mstvisible="2">2-1. Machine :</label>
                    <select id="para-process" _mstvisible="2"><option value="-" _mstvisible="3">-</option><option value="Electrode Supply" _msttexthash="291330" _msthash="90" _mstvisible="3">Electrode Supply</option><option value="Lamination" _msttexthash="157508" _msthash="91" _mstvisible="3">Lamination</option><option value="D-Stacking" _msttexthash="145041" _msthash="92" _mstvisible="3">D-Stacking</option><option value="Taper" _msttexthash="60268" _msthash="93" _mstvisible="3">Taper</option><option value="Inspection" _msttexthash="159224" _msthash="94" _mstvisible="3">Inspection</option></select>
                </div>


                <div class="form-group" _mstvisible="1">
                    <label for="para-unit" _msttexthash="100542" _msthash="95" _mstvisible="2">2-2. Unit :</label>
                    <select id="para-unit" _mstvisible="2">
                        <option value="-" _mstvisible="3">-</option>

                    </select>
                </div>

                <div class="form-group" _mstvisible="1">
                    <label for="para-assy" _msttexthash="109538" _msthash="96" _mstvisible="2">2-3. Assy' :</label>
                    <select id="para-assy" _mstvisible="2">
                        <option value="-" _mstvisible="3">-</option>

                    </select>
                </div>


                <div class="form-group" _mstvisible="1">
                    <label for="para-time" _msttexthash="204113" _msthash="97" _mstvisible="2">3. Change time:</label>
                    <input type="datetime-local" id="para-time" _mstvisible="2">
                </div>
                <div class="form-group" _mstvisible="1">
                    <label for="para-worker" _msttexthash="131989" _msthash="98" _mstvisible="2">4. Changer:</label>
                    <input type="text" id="para-worker" placeholder="ÏûëÏóÖÏûê Ïù¥Î¶Ñ" _mstplaceholder="29320967" _mstvisible="2">
                </div>
                <div class="form-group" _mstvisible="1">
                    <label for="para-parameter" _msttexthash="195780" _msthash="99" _mstvisible="2">5. ChangePara:</label>
                    <input type="text" id="para-parameter" placeholder="Î≥ÄÍ≤Ω ÌååÎùºÎØ∏ÌÑ∞ ÏûÖÎ†•" _mstplaceholder="53870687" _mstvisible="2">
                </div>
                <div class="form-group" _mstvisible="1">
                    <label for="para-before" _msttexthash="296816" _msthash="100" _mstvisible="2">6. Transfer value:</label>
                    <input type="text" id="para-before" placeholder="Ïù¥Ï†Ñ Í∞í ÏûÖÎ†•" _mstplaceholder="28506699" _mstvisible="2">
                </div>
                <div class="form-group" _mstvisible="1">
                    <label for="para-after" _msttexthash="232427" _msthash="101" _mstvisible="2">7. Change value:</label>
                    <input type="text" id="para-after" placeholder="Î≥ÄÍ≤Ω Í∞í ÏûÖÎ†•" _mstplaceholder="27531127" _mstvisible="2">
                </div>
                <div class="form-group" _mstvisible="1">
                    <label for="para-reason" _msttexthash="353223" _msthash="102" _mstvisible="2">8. Reason for change:</label>
                    <textarea id="para-reason" placeholder="Î≥ÄÍ≤Ω ÏÇ¨Ïú† ÏûÖÎ†•" _mstplaceholder="36051899" _mstvisible="2"></textarea>
                </div>
                <button class="button" onclick="generateParameterText()" _msttexthash="179127" _msthash="103" _mstvisible="1">Create a form</button>
            </div>
            
            <!-- Î∂ÄÎèôÎÇ¥Ïó≠ Ìèº -->

            <!-- ÏõêÎûòÍ±∞ div id="troubleForm" class="form" -->
            <div id="troubleForm" class="form active">
                <div class="form-group">
                    <label for="trouble-type" _msttexthash="71955" _msthash="104">Types:</label>
                    <select id="trouble-type">
                        <option value="BM" _msttexthash="14014" _msthash="105">BM</option>
                        <option value="PD" _msttexthash="14352" _msthash="106">PD</option>
                        <option value="PM" _msttexthash="15288" _msthash="107">PM</option>
                        <option value="ÏÉùÏÇ∞Ï§ÄÎπÑ" _msttexthash="21975447" _msthash="108">Preparation for production</option>
                    </select>                   
                </div>

                <div class="form-group">
                    <label for="trouble-site" _msttexthash="74659" _msthash="109">0. Site :</label>
                    <select id="trouble-site">
                        <option value="-">-</option>
                        <option value="WA" _msttexthash="14677" _msthash="110">WA</option>
                        <option value="WA5" _msttexthash="20878" _msthash="111">WA5</option>
                        <option value="UC1" _msttexthash="20436" _msthash="112">UC1</option>
                        <option value="UC2" _msttexthash="20553" _msthash="113">UC2</option>
                        <option value="MI1" _msttexthash="20332" _msthash="114">MI1</option>
                        <option value="MI2" _msttexthash="20449" _msthash="115">MI2</option>
                        <option value="MI3" _msttexthash="20566" _msthash="116">MI3</option>
                        <option value="NSE" _msttexthash="23803" _msthash="117">NSE</option>
                        <option value="L-H" _msttexthash="20020" _msthash="118">L-H</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="trouble-machine" _msttexthash="115544" _msthash="119">1. Volume:</label>
                    <select id="trouble-machine"><option value="-">-</option><option value="1-1" _msttexthash="14872" _msthash="120">1-1</option><option value="1-2" _msttexthash="14989" _msthash="121">1-2</option><option value="1-3" _msttexthash="15106" _msthash="122">1-3</option><option value="1-4" _msttexthash="15223" _msthash="123">1-4</option><option value="1-5" _msttexthash="15340" _msthash="124">1-5</option><option value="1-H" _msttexthash="17563" _msthash="125">1-H</option><option value="2-1" _msttexthash="14963" _msthash="126">2-1</option><option value="2-2" _msttexthash="15080" _msthash="127">2-2</option><option value="2-3" _msttexthash="15197" _msthash="128">2-3</option><option value="2-4" _msttexthash="15314" _msthash="129">2-4</option><option value="2-5" _msttexthash="15431" _msthash="130">2-5</option><option value="2-H" _msttexthash="17654" _msthash="131">2-H</option><option value="3-1" _msttexthash="15054" _msthash="132">3-1</option><option value="3-2" _msttexthash="15171" _msthash="133">3-2</option><option value="3-3" _msttexthash="15288" _msthash="134">3-3</option><option value="3-4" _msttexthash="15405" _msthash="135">3-4</option><option value="3-5" _msttexthash="15522" _msthash="136">3-5</option><option value="4-1" _msttexthash="15145" _msthash="137">4-1</option><option value="4-2" _msttexthash="15262" _msthash="138">4-2</option><option value="4-3" _msttexthash="15379" _msthash="139">4-3</option><option value="4-4" _msttexthash="15496" _msthash="140">4-4</option><option value="4-5" _msttexthash="15613" _msthash="141">4-5</option><option value="4-6" _msttexthash="15730" _msthash="142">4-6</option></select>
                </div>
                <div class="form-group">
                    <label for="trouble-process" _msttexthash="161993" _msthash="143">2-1. Machine :</label>
                    <select id="trouble-process"><option value="-">-</option><option value="Electrode Supply" _msttexthash="291330" _msthash="144">Electrode Supply</option><option value="Lamination" _msttexthash="157508" _msthash="145">Lamination</option><option value="D-Stacking" _msttexthash="145041" _msthash="146">D-Stacking</option><option value="Taper" _msttexthash="60268" _msthash="147">Taper</option><option value="Inspection" _msttexthash="159224" _msthash="148">Inspection</option></select>
                </div>

                <div class="form-group">
                    <label for="trouble-unit" _msttexthash="100542" _msthash="149">2-2. Unit :</label>
                    <select id="trouble-unit"><option value="-">-</option><option value="TapedCell.Vision" _msttexthash="297115" _msthash="189">TapedCell.Vision</option><option value="TapedCell.Rotate" _msttexthash="294593" _msthash="188">TapedCell.Rotate</option><option value="TapedCell.ShortInspector" _msttexthash="590941" _msthash="187">TapedCell.ShortInspector</option><option value="Cell.TrackingSystem" _msttexthash="404950" _msthash="186">Cell.TrackingSystem</option><option value="TapedCell.Transfer" _msttexthash="360204" _msthash="185">TapedCell.Transfer</option><option value="TapedCell.Unloader" _msttexthash="356980" _msthash="184">TapedCell.Unloader</option></select>
                </div>

                <div class="form-group">
                    <label for="trouble-assy" _msttexthash="109538" _msthash="156">2-3. Assy' :</label>
                    <select id="trouble-assy"><option value="-">-</option><option value="[01] Taped Cell. Pick &amp; Place" _msttexthash="519389" _msthash="157">[01] Taped Cell. Pick &amp; Place</option><option value="[Upper/Lower] Taped Cell. Vision" _msttexthash="777231" _msthash="158">[Upper/Lower] Taped Cell. Vision</option><option value="[4-side] Taped Cell. Vision" _msttexthash="557453" _msthash="159">[4-side] Taped Cell. Vision</option><option value="Taped Cell. Rotating Table" _msttexthash="532636" _msthash="160">Taped Cell. Rotating Table</option><option value="[02] Taped Cell. Pick &amp; Place" _msttexthash="519506" _msthash="161">[02] Taped Cell. Pick &amp; Place</option><option value="Taped Cell. Weight Inspector" _msttexthash="629044" _msthash="162">Taped Cell. Weight Inspector</option></select>
                </div>


                <div class="form-group">
                    <label for="trouble-time" _msttexthash="375167" _msthash="163">3-1. Occurrence time:</label>
                    <input type="datetime-local" id="trouble-time" max="2026-01-18T16:50">
                </div>
                <div class="form-group">
                    <label for="trouble-complete" _msttexthash="608413" _msthash="164">3-2. Completion of Measures:</label>
                    <input type="datetime-local" id="trouble-complete" max="2026-01-18T16:50" min="2026-01-17T11:50">
                </div>
                <div class="form-group">
                    <label for="trouble-worker" _msttexthash="139425" _msthash="165">4. Workers:</label>
                    <input type="text" id="trouble-worker" placeholder="ÏûëÏóÖÏûê Ïù¥Î¶Ñ" required="" _mstplaceholder="29320967">
                </div>
                <div class="form-group">
                    <label for="trouble-problem" _msttexthash="209859" _msthash="166">5. Phenomenon:</label>
                    <textarea id="trouble-problem" placeholder="ÌòÑÏÉÅ ÏûÖÎ†•" _mstplaceholder="22221927"></textarea>
                </div>
                <div class="form-group">
                    <label for="trouble-reason" _msttexthash="114127" _msthash="167">6. Causes:</label>
                    <textarea id="trouble-reason" placeholder="ÏõêÏù∏ ÏûÖÎ†•" _mstplaceholder="22046531"></textarea>
                </div>
                <div class="form-group">
                    <label for="trouble-action" _msttexthash="113321" _msthash="168">7. Action:</label>
                    <textarea id="trouble-action" placeholder="Ï°∞Ïπò ÎÇ¥Ïö© ÏûÖÎ†•" _mstplaceholder="36725117"></textarea>
                </div>
                <button class="button" onclick="generateTroubleText()" _msttexthash="179127" _msthash="169">Create a form</button>
            </div>
            
            <!-- Í≤∞Í≥º ÌëúÏãú ÏòÅÏó≠ -->
            <!-- <div id="result" class="result">
                <p id="resultText"></p>
                <div>
                    <button id="uploadButton" class="button" onclick="uploadContent()">ÏóÖÎ°úÎìú Î∞è Í≥µÏú†ÌïòÍ∏∞</button>
                    <button id="openButton" class="button" onclick="openContent()">Î∂ÄÎèôÎÇ¥Ïó≠ ÏãúÌä∏</button>
                </div>
            </div> -->

            <div id="result" class="result" _msthidden="2" style="display: none;">
                <p id="resultText"></p>
                <div id="statusMessage" style="display:none; text-align:center; color:#555;" _msttexthash="25027782" _msthidden="1" _msthash="170">‚è≥ ÏóÖÎ°úÎìú Ï§ë...</div>
                <div _msthidden="1">
                    <button id="uploadButton" class="button" onclick="uploadContent()" _msttexthash="52821028" _msthidden="1" _msthash="171">ÏóÖÎ°úÎìú Î∞è Í≥µÏú†ÌïòÍ∏∞</button>
                    <!-- <button id="openButton" class="button" onclick="openContent()">Î∂ÄÎèôÎÇ¥Ïó≠ ÏãúÌä∏</button> -->
                </div>
            </div>

            <div id="status-alert" class="alert-box">
                <span id="alert-message"></span>
            </div>
        </div>
        
        <div class="footer">
            @
        </div>
    </div>

    <script>
        
// site Í∞íÏóê Îî∞Îùº process ÏòµÏÖò Î™©Î°ù Ï†ïÏùò
const siteToProcess = {
  MI1:       ['Electrode Supply', 'Lamination', 'Stacking', 'Taper', 'Inspection'],
  WA5:       ['Electrode Supply', 'Lamination', 'Stacking', 'Taper', 'Inspection'],
  default:   ['Electrode Supply', 'Lamination', 'D-Stacking', 'Taper', 'Inspection']
};

const siteEl = document.getElementById('trouble-site');
const procEl = document.getElementById('trouble-process');
const siteE2 = document.getElementById('para-site');
const procE2 = document.getElementById('para-process');

// site Î≥ÄÍ≤Ω Ïãú process ÏòµÏÖò ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
function updateProcessOptions() {
    // siteToProcess[site] Í∞Ä ÏóÜÏúºÎ©¥ default ÏÇ¨Ïö©
    const list = siteToProcess[siteEl.value] || siteToProcess.default;
    const list_para = siteToProcess[siteE2.value] || siteToProcess.default;

    // Í∏∞Ï°¥ ÏòµÏÖò Ï¥àÍ∏∞Ìôî
    procEl.innerHTML = '';
    procEl.appendChild(new Option('-', '-'));

    procE2.innerHTML = '';
    procE2.appendChild(new Option('-', '-'));

    // ÏÉàÎ°ú Ï†ïÏùòÎêú ÏòµÏÖò ÏÇΩÏûÖ
    list.forEach(p => {
        procEl.appendChild(new Option(p, p));
    });

    list_para.forEach(p => {
        procE2.appendChild(new Option(p, p));
    });

    // ÏÑ†ÌÉù Ï¥àÍ∏∞Ìôî
    procEl.value = '-';
    procE2.value = '-';
}

// ÌéòÏù¥ÏßÄ Î°úÎìúÏãúÏôÄ site Î≥ÄÍ≤Ω ÏãúÏóê Ìò∏Ï∂ú
siteEl.addEventListener('change', updateProcessOptions);
siteE2.addEventListener('change', updateProcessOptions);
updateProcessOptions();  // ÏµúÏ¥à Î°úÎìúÏãúÏóêÎèÑ Ï†ÅÏö©

const MAIL_SUBJECT = 'PRI L&S Í≥µÏú†(ÏûêÎèô Î∞úÏÜ°)';

const statusMessage = document.getElementById('statusMessage');
const resultText = document.getElementById('resultText');
async function uploadContent() {
    // 1. DOM ÏöîÏÜå Í∞ÄÏ†∏Ïò§Í∏∞
    const uploadButton = document.getElementById('uploadButton');
    const resultText = document.getElementById('resultText');
    const statusAlert = document.getElementById('status-alert');
    const alertMessage = document.getElementById('alert-message');

    // 2. ÏóÖÎ°úÎìú ÏãúÏûë: Î≤ÑÌäº ÎπÑÌôúÏÑ±Ìôî, ÏïåÎ¶ºÏ∞Ω ÌëúÏãú Î∞è Î©îÏãúÏßÄ ÏÑ§Ï†ï
    uploadButton.disabled = true;
    alertMessage.innerText = '‚è≥ ÏóÖÎ°úÎìú Î∞è Í≥µÏú† ÏßÑÌñâ Ï§ë...';
    statusAlert.classList.add('show');

    // üí° ÌïµÏã¨ ÏàòÏ†ï ÏãúÏûë: Ï†ÑÏ≤¥ ÌÖçÏä§Ìä∏Î•º Í∞ÄÏ†∏ÏôÄ Î©ÄÌã∞ÎùºÏù∏ ÌååÏã±ÏùÑ Ï§ÄÎπÑÌï©ÎãàÎã§.
    const fullText = resultText.innerText.trim();
    const isTrouble = fullText.startsWith("[Î∂ÄÎèô&ÏûëÏóÖ Í≥µÏú†]");

    // ÎùºÎ≤® Î™©Î°ù (generateTroubleText / generateParameterTextÏôÄ Î∞òÎìúÏãú ÎèôÏùºÌï¥Ïïº Ìï®)
    const troubleLabels = [
        "Ï¢ÖÎ•ò:",
        "0. Site :",
        "1. Ìò∏Í∏∞ :",
        "2-1. Machine :",
        "2-2. Unit :",
        "2-3. Assy' :",
        "3-1. Î∞úÏÉùÏãúÍ∞Ñ :",
        "3-2. Ï°∞ÏπòÏôÑÎ£å :",
        "4. ÏûëÏóÖÏûê :",
        "5. ÌòÑÏÉÅ :",
        "6. ÏõêÏù∏ :",
        "7. Ï°∞Ïπò :",
    ];

    const paraLabels = [
        "0. Site :",
        "1. Ìò∏Í∏∞ :",
        "2-1. Machine :",
        "2-2. Unit :",
        "2-3. Assy' :",
        "3. Î≥ÄÍ≤ΩÏãúÍ∞Ñ :",
        "4. Î≥ÄÍ≤ΩÏûê :",
        "5. Î≥ÄÍ≤ΩPara :",
        "6. Ïù¥Ï†ÑÍ∞í :",
        "7. Î≥ÄÍ≤ΩÍ∞í :",
        "8. Î≥ÄÍ≤ΩÏÇ¨Ïú† :",
    ];

    // ‚öôÔ∏è ÏÉà getValue: Ï†ïÍ∑úÏãù Ïïà Ïì∞Í≥†, ÎùºÎ≤® ÏúÑÏπòÎ°úÎßå ÏûêÎ•¥Í∏∞
    const getValue = (label) => {
        const text = fullText;                 // uploadContent ÏïàÏóê Ïù¥ÎØ∏ ÏûàÎäî Ï†ÑÏ≤¥ Î¨∏ÏûêÏó¥
        const labels = isTrouble ? troubleLabels : paraLabels;

        // 1) Ïù¥ ÎùºÎ≤®Ïù¥ Ïñ¥Îîî ÏûàÎäîÏßÄ Ï∞æÍ∏∞
        const start = text.indexOf(label);
        if (start === -1) return "";           // ÎùºÎ≤® ÏóÜÏúºÎ©¥ Îπà Î¨∏ÏûêÏó¥

        const valueStart = start + label.length;

        // 2) Ïù¥ ÎùºÎ≤® Îí§Ïóê ÎÇòÏò§Îäî "Îã§Ïùå ÎùºÎ≤®"Ïùò ÏúÑÏπòÎ•º Ï∞æÍ∏∞
        let nextIndex = text.length;
        for (const lb of labels) {
            if (lb === label) continue;        // ÏûêÍ∏∞ ÏûêÏã†ÏùÄ Í±¥ÎÑàÎúÄ
            const idx = text.indexOf(lb, valueStart);
            if (idx !== -1 && idx < nextIndex) {
                nextIndex = idx;
            }
        }

        // 3) ÌòÑÏû¨ ÎùºÎ≤® Îí§Î∂ÄÌÑ∞, Îã§Ïùå ÎùºÎ≤® ÏßÅÏ†ÑÍπåÏßÄÍ∞Ä Ïù¥ Ìï≠Î™©Ïùò Í∞í
        const raw = text.slice(valueStart, nextIndex);

        return raw.trim();
    };

    
    let data;

    if (isTrouble) {
        data = {
            type: getValue("Ï¢ÖÎ•ò:"),
            site: getValue("0. Site :"),
            machine: "'" + getValue("1. Ìò∏Í∏∞ :"),
            process: getValue("2-1. Machine :"),
            unit: getValue("2-2. Unit :"),
            assy: getValue("2-3. Assy' :"),
            time: getValue("3-1. Î∞úÏÉùÏãúÍ∞Ñ :"),
            complete: getValue("3-2. Ï°∞ÏπòÏôÑÎ£å :"),
            worker: getValue("4. ÏûëÏóÖÏûê :"),
            // üëá Î©ÄÌã∞ÎùºÏù∏ ÌïÑÎìúÎäî isMultiLine Ïù∏ÏàòÎ•º ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÍ≥†, 
            //    Ï†ïÍ∑úÏãù ÎÇ¥Î∂ÄÏóêÏÑú ÏàúÏÑúÏóê ÎßûÍ≤å Îã§Ïùå ÎùºÎ≤®ÍπåÏßÄ Ï∂îÏ∂úÌïòÎèÑÎ°ù ÏÑ§Ï†ïÌñàÏäµÎãàÎã§.
            problem: getValue("5. ÌòÑÏÉÅ :"),
            reason: getValue("6. ÏõêÏù∏ :"),
            action: getValue("7. Ï°∞Ïπò :"),
        };
    } else { // Para/IP Î≥ÄÍ≤Ω Ìèº
        data = {
            type: 'Para/IP Î≥ÄÍ≤Ω',
            site: getValue("0. Site :"),
            machine: "'" + getValue("1. Ìò∏Í∏∞ :"), // # Ï∂îÍ∞ÄÌïòÎì†, ' ' ' Ï∂îÍ∞ÄÌïòÎì†
            process: getValue("2-1. Machine :"),
            unit: getValue("2-2. Unit :"),
            assy: getValue("2-3. Assy' :"),
            time: getValue("3. Î≥ÄÍ≤ΩÏãúÍ∞Ñ :"),
            // Para/IP ÌèºÏóêÏÑú 'complete' ÏûêÎ¶¨Ïóê '8. Î≥ÄÍ≤ΩÏÇ¨Ïú†'Í∞Ä Îì§Ïñ¥Í∞ê
            complete: getValue("8. Î≥ÄÍ≤ΩÏÇ¨Ïú† :"),
            worker: getValue("4. Î≥ÄÍ≤ΩÏûê :"),
            problem: getValue("5. Î≥ÄÍ≤ΩPara :"),
            reason: getValue("6. Ïù¥Ï†ÑÍ∞í :"),
            action: getValue("7. Î≥ÄÍ≤ΩÍ∞í :"),
            // '8. Î≥ÄÍ≤ΩÏÇ¨Ïú†'Î•º Ïû¨ÏÇ¨Ïö©ÌïòÏó¨ Î©ÄÌã∞ÎùºÏù∏ÏúºÎ°ú Ï∂îÏ∂ú
            para_reason: getValue("8. Î≥ÄÍ≤ΩÏÇ¨Ïú† :"),
        };
        // Para/IP ÌèºÏóêÏÑúÎäî 'complete' ÌïÑÎìúÎ•º '8. Î≥ÄÍ≤ΩÏÇ¨Ïú†'Î°ú ÏÇ¨Ïö©ÌïòÎäî Íµ¨Ï°∞Í∞Ä 
        // Îç∞Ïù¥ÌÑ∞ Ï†ÑÏÜ°Ïóê Î¨∏Ï†úÍ∞Ä ÏûàÎã§Î©¥, ÏïÑÎûòÏôÄ Í∞ôÏù¥ 'reason'Í≥º ÎèôÏùºÌïòÍ≤å ÎßûÏ∂îÎäî Í≤ÉÏù¥ Ï¢ãÏäµÎãàÎã§.
        data.complete = data.para_reason; 
        delete data.para_reason;
    }
    
    // Ïù¥ ÏãúÏ†êÏóêÏÑú data Í∞ùÏ≤¥Ïùò 'problem', 'reason', 'action' Í∞íÏùÄ 
    // ÏûÖÎ†•Îêú Ïó¨Îü¨ Ï§Ñ ÎÇ¥Ïö©(Ï§ÑÎ∞îÍøà Î¨∏Ïûê \n Ìè¨Ìï®)ÏùÑ Ïò®Ï†ÑÌûà Í∞ÄÏßÄÍ≥† ÏûàÏäµÎãàÎã§.
    // Îî∞ÎùºÏÑú Î∞±ÏóîÎìú(Sheets/Worker)Î°ú Ï†ÑÏÜ°ÎêòÏñ¥ÎèÑ Ï§ÑÎ∞îÍøàÏù¥ Ïú†ÏßÄÎê©ÎãàÎã§.

    const WORKER_BASE = "https://fragrant-band-2b4e.limchickennn.workers.dev";
    
    const fetchPromises = [
        fetch("https://appendtosheet-ymlfqhclja-uc.a.run.app", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
        }),
        fetch(`${WORKER_BASE}/pa`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(data),
        }),
    ];

    try {
        // 4. Î™®Îì† ÎπÑÎèôÍ∏∞ ÏöîÏ≤≠ÏùÑ Î≥ëÎ†¨Î°ú Ïã§Ìñâ
        await Promise.all(fetchPromises);
        
        // 5. ÏÑ±Í≥µ Ïãú: Î©îÏãúÏßÄ Î≥ÄÍ≤Ω Î∞è Í≥µÏú† Ìï®Ïàò Ìò∏Ï∂ú (shareContentWithRetry Ìï®ÏàòÎäî Í∑∏ÎåÄÎ°ú ÏûàÎã§Í≥† Í∞ÄÏ†ï)
        alertMessage.innerText = '‚úÖ Í≥µÏú† ÏãúÌä∏ ÏóÖÎ°úÎìú ÏÑ±Í≥µ!';
        shareContentWithRetry();

    } catch (error) {
        // 6. Ïã§Ìå® Ïãú: Î©îÏãúÏßÄ Î≥ÄÍ≤Ω Î∞è Ïò§Î•ò Î°úÍπÖ
        console.error("ÏóÖÎ°úÎìú Ïò§Î•ò:", error);
        alertMessage.innerText = '‚ùå ÏóÖÎ°úÎìú Ï§ë Ïò§Î•ò Î∞úÏÉù!';

    } finally {
        // 7. ÏùºÏ†ï ÏãúÍ∞Ñ ÌõÑ ÏïåÎ¶ºÏ∞Ω Ïà®Í∏∞Í≥†, Î≤ÑÌäº ÌôúÏÑ±Ìôî
        setTimeout(() => {
            statusAlert.classList.remove('show');
            uploadButton.disabled = false;
        }, 5000); // 5Ï¥à ÌõÑÏóê ÏïåÎ¶ºÏ∞Ω Ïà®ÍπÄ
    }
}


document.getElementById('para-site').addEventListener('change', function () {
    const site = this.value;
    const machineSelect = document.getElementById('para-machine');
    machineSelect.innerHTML = ''; // Í∏∞Ï°¥ ÏòµÏÖò Ï†úÍ±∞

    let options = [];
    if (site === 'WA') {
        options = ['-', '26-1', '26-2', '26-3', '26-4', '26-5', '26-H', '27-1', '27-2', '27-3', '27-4', '27-5', '28-1', '28-2', '28-3', '28-4', '28-5', '28-6', '29-1(HCÍ≤∏Ïö©)', '29-2', '29-3'];
    } else if (site === 'WA5') {
    options = ['-', 
        '11-1','11-2','11-3','11-4',
        '12-1','12-2','12-3','12-4',
        '13-1','13-2','13-3','13-4',
        '14-1','14-2','14-3','14-4',
        '15-1','15-2','15-3','15-4',
        '16-1','16-2','16-3','16-4',
        '17-1','17-2','17-3','17-4',
        '18-1','18-2','18-3','18-4',
        '19-1','19-2','19-3','19-4'];
    } else if (site === 'UC1') {
        options = ['-', 'HC1', 'HC2', '1-1', '1-2', '1-3', '2-1', '2-2', '2-3', '3-1', '3-2', '3-3', '4-1', '4-2', '4-3', '5-1', '5-2', '5-3', 'HC3', 'HC4', '6-1', '6-2', '6-3', '7-1', '7-2', '7-3', '8-1', '8-2', '8-3', '9-1', '9-2', '9-3', '10-1', '10-2', '10-3'];
    } else if (site === 'UC2') {
        options = ['-', 'HC1', 'HC2', '1-1', '1-2', '1-3', '2-1', '2-2', '2-3', '3-1', '3-2', '3-3', '4-1', '4-2', '4-3', '5-1', '5-2', '5-3', 'HC3', 'HC4', '6-1', '6-2', '6-3', '7-1', '7-2', '7-3', '8-1', '8-2', '8-3', '9-1', '9-2', '9-3', '10-1', '10-2', '10-3'];
    } else if (site === 'MI1') {
        options = ['-', '1-1', '1-2', '1-3', '1-4', '1-5', '1-H', '2-1', '2-2', '2-3', '2-4'];
    } else if (site === 'MI2') {
        options = ['-', '3-1', '3-2', '3-3', '3-4', '3-5', '3-H', '4-1', '4-2', '4-3', '4-4', '4-5', '4-6', '5-1', '5-2', '5-3', '5-4', '5-5(HCÍ≤∏Ïö©)'];
    } else if (site === 'MI3') {
        options = ['-', 'HC1', 'HC2', '1-1', '1-2', '1-3', '2-1', '2-2', '2-3', '3-1', '3-2', '3-3', '4-1', '4-2', '4-3', '5-1', '5-2', '5-3'];
    } else if (site === 'NSE') {
        options = ['-', '1-1', '1-2', '1-3', '1-4', '1-5', '1-H', '2-1', '2-2', '2-3', '2-4', '2-5', '2-H', '3-1', '3-2', '3-3', '3-4', '3-5', '4-1', '4-2', '4-3', '4-4', '4-5', '4-6'];
    } else if (site === 'L-H') {
        options = ['-', '1-1', '1-2', '1-3', '2-1', '2-2', '2-3', '2-4', '3-1', '3-2', '3-3', '4-1', '4-2', '4-3', '5-1', '5-2', '5-3', '6-1', '6-2', '6-3', 'HC1', 'HC2'];
    } else {
        options = ['Í∏∞ÌÉÄ']; // Îã§Î•∏ site ÏÑ†ÌÉù Ïãú Í∏∞Î≥∏ ÏòµÏÖò
    }

    options.forEach(function (opt) {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        machineSelect.appendChild(option);
    });
});

// TroubleFormÎèÑ ÎèôÏùºÌïòÍ≤å
document.querySelectorAll('#troubleForm select[id="trouble-site"]')[0]
    ?.addEventListener('change', function () {
    const site = this.value;
    const machineSelect = document.getElementById('trouble-machine');
    machineSelect.innerHTML = '';

    let options = [];
    if (site === 'WA') {
        options = ['-', '26-1', '26-2', '26-3', '26-4', '26-5', '26-H', '27-1', '27-2', '27-3', '27-4', '27-5', '28-1', '28-2', '28-3', '28-4', '28-5', '28-6', '29-1(HCÍ≤∏Ïö©)', '29-2', '29-3'];
    } else if (site === 'WA5') {
    options = ['-', 
        '11-1','11-2','11-3','11-4',
        '12-1','12-2','12-3','12-4',
        '13-1','13-2','13-3','13-4',
        '14-1','14-2','14-3','14-4',
        '15-1','15-2','15-3','15-4',
        '16-1','16-2','16-3','16-4',
        '17-1','17-2','17-3','17-4',
        '18-1','18-2','18-3','18-4',
        '19-1','19-2','19-3','19-4'];
    } else if (site === 'UC1') {
        options = ['-', 'HC1', 'HC2', '1-1', '1-2', '1-3', '2-1', '2-2', '2-3', '3-1', '3-2', '3-3', '4-1', '4-2', '4-3', '5-1', '5-2', '5-3', 'HC3', 'HC4', '6-1', '6-2', '6-3', '7-1', '7-2', '7-3', '8-1', '8-2', '8-3', '9-1', '9-2', '9-3', '10-1', '10-2', '10-3'];
    } else if (site === 'UC2') {
        options = ['-', 'HC1', 'HC2', '1-1', '1-2', '1-3', '2-1', '2-2', '2-3', '3-1', '3-2', '3-3', '4-1', '4-2', '4-3', '5-1', '5-2', '5-3', 'HC3', 'HC4', '6-1', '6-2', '6-3', '7-1', '7-2', '7-3', '8-1', '8-2', '8-3', '9-1', '9-2', '9-3', '10-1', '10-2', '10-3'];
    } else if (site === 'MI1') {
        options = ['-', '1-1', '1-2', '1-3', '1-4', '1-5', '1-H', '2-1', '2-2', '2-3', '2-4'];
    } else if (site === 'MI2') {
        options = ['-', '3-1', '3-2', '3-3', '3-4', '3-5', '3-H', '4-1', '4-2', '4-3', '4-4', '4-5', '4-6', '5-1', '5-2', '5-3', '5-4', '5-5(HCÍ≤∏Ïö©)'];
    } else if (site === 'MI3') {
        options = ['-', 'HC1', 'HC2', '1-1', '1-2', '1-3', '2-1', '2-2', '2-3', '3-1', '3-2', '3-3', '4-1', '4-2', '4-3', '5-1', '5-2', '5-3'];
    } else if (site === 'NSE') {
        options = ['-', '1-1', '1-2', '1-3', '1-4', '1-5', '1-H', '2-1', '2-2', '2-3', '2-4', '2-5', '2-H', '3-1', '3-2', '3-3', '3-4', '3-5', '4-1', '4-2', '4-3', '4-4', '4-5', '4-6'];
    } else if (site === 'L-H') {
        options = ['-', '1-1', '1-2', '1-3', '2-1', '2-2', '2-3', '2-4', '3-1', '3-2', '3-3', '4-1', '4-2', '4-3', '5-1', '5-2', '5-3', '6-1', '6-2', '6-3', 'HC1', 'HC2'];
    } else {
        options = ['Í∏∞ÌÉÄ']; // Îã§Î•∏ site ÏÑ†ÌÉù Ïãú Í∏∞Î≥∏ ÏòµÏÖò
    }

    options.forEach(function (opt) {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        machineSelect.appendChild(option);
    });
});


// ÌååÎùºÏú†Îãõ ÏÑ†ÌÉùÌï≠Î™© Ìï®Ïàò
document.getElementById('para-process').addEventListener('change', function () {
    const site = document.getElementById('para-site').value;
    const process = this.value;
    const unitSelect = document.getElementById('para-unit');

    // Í∏∞Ï°¥ ÏòµÏÖò Ï†úÍ±∞
    unitSelect.innerHTML = '';

    let options = [];

    if (site === 'MI1' || site === 'WA5') {
        if (process === 'Electrode Supply') {
            options = ['-', 'Electrode. Unwinder'];
        } 
        else if (process === 'Lamination') {
            options = [
                '-',
                'Separator.Unwinder',
                'Electrode/Separator.Combiner',
                'Laminator',
                'Cell. Final Cutter',
                'Cell. Inspector',
                'Cell.Unloader',
                'Magazine. Buffer',
                'Cell. Tracking System'
            ];
        } else if (process === 'Stacking') {
            options = [
                '-',
                'Cell.Conveyor',
                'Cell.Distributor',
                'Cell.Aligner',
                'Stacked Cell. Transfer'
            ];
        } else if (process === 'Taper') {
            options = [
                '-',
                'Stacked Cell. Loader',
                'LMS',
                'Half Cell. Stacker',
                'Stacked Cell. Taper',
                'Stacked Cell. Unloader'
            ];
        } else if (process === 'Inspection') {
            options = [
                '-',
                'Taped Cell. Vision',
                'Taped Cell. Weight Inspector',
                'Taped Cell. Short Checker',
                'Taped Cell. Transfer Unit',
                'Taped Cell. Unloader'
            ];
        } else {
            options = ['Í∏∞ÌÉÄ']; // Í∏∞Î≥∏Í∞í ÎòêÎäî Í≥µÏ†ï Ïô∏ Ìï≠Î™© Ï≤òÎ¶¨
        }
    }

    else {
        if (process === 'Electrode Supply') {
            options = ['-', 'Pancake.Loader'];
        } else if (process === 'Lamination') {
            options = ['-', 'Separator. Unwinder', 'Electrode/Separator.Combiner', 'Laminator', 'Cell.FinalCutter', 'Cell.TrackingSystem', 'Cell.Inspector', 'Cell.Unloader'];
        } else if (process === 'D-Stacking') {
            options = ['-', '[01]Cell.Loading C/V', '[02]Cell.Loading C/V', '[01]Cell.Stacker', '[02]Cell.Stacker', '[03]Cell.Stacker', 'Stacked Cell.Transfer'];
        } else if (process === 'Taper') {
            options = ['-', 'HalfCell.Loading', 'HalfCell.Stack', 'LMS', '[01]StackedCell.Taper', '[02]StackedCell.Taper'];
        } else if (process === 'Inspection') {
            options = ['-', 'TapedCell.Vision', 'TapedCell.Rotate', 'TapedCell.ShortInspector', 'Cell.TrackingSystem', 'TapedCell.Transfer', 'TapedCell.Unloader'];
        }
        else {
            options = ['Í∏∞ÌÉÄ']; // Í∏∞Î≥∏Í∞í ÎòêÎäî Í≥µÏ†ï Ïô∏ Ìï≠Î™© Ï≤òÎ¶¨
        }
    }

    options.forEach(function (opt) {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        unitSelect.appendChild(option);
    });
});

// Ìä∏Îü¨Î∏îÏú†Îãõ ÏÑ†ÌÉùÌï≠Î™© Ìï®Ïàò
document.getElementById('trouble-process').addEventListener('change', function () {
    const site = document.getElementById('trouble-site').value;
    const process = this.value;
    const unitSelect = document.getElementById('trouble-unit');

    // Í∏∞Ï°¥ ÏòµÏÖò Ï†úÍ±∞
    unitSelect.innerHTML = '';

    let options = [];

    if (site === 'MI1'|| site === 'WA5') {
        if (process === 'Electrode Supply') {
            options = ['-', 'Electrode. Unwinder'];
        } 
        else if (process === 'Lamination') {
            options = [
                '-',
                'Separator.Unwinder',
                'Electrode/Separator.Combiner',
                'Laminator',
                'Cell.Final Cutter',
                'Cell.Inspector',
                'Cell.Unloader',
                'Magazine. Buffer',
                'Cell. Tracking System'
            ];
        } else if (process === 'Stacking') {
            options = [
                '-',
                'Cell.Conveyor',
                'Cell.Distributor',
                'Cell.Aligner',
                'Stacked Cell.Transfer'
            ];
        } else if (process === 'Taper') {
            options = [
                '-',
                'Stacked Cell.Loader',
                'LMS',
                'Half Cell.Stacker',
                'Stacked Cell.Taper',
                'Stacked Cell.Unloader'
            ];
        } else if (process === 'Inspection') {
            options = [
                '-',
                'Taped Cell.Vision',
                'Taped Cell.Weight Inspector',
                'Taped Cell.Short Checker',
                'Taped Cell.Transfer Unit',
                'Taped Cell.Unloader'
            ];
        } else {
            options = ['Í∏∞ÌÉÄ']; // Í∏∞Î≥∏Í∞í ÎòêÎäî Í≥µÏ†ï Ïô∏ Ìï≠Î™© Ï≤òÎ¶¨
        }

    }
    else {
        if (process === 'Electrode Supply') {
            options = ['-', 'Pancake.Loader'];
        } else if (process === 'Lamination') {
            options = ['-', 'Separator. Unwinder', 'Electrode/Separator.Combiner', 'Laminator', 'Cell.FinalCutter', 'Cell.TrackingSystem', 'Cell.Inspector', 'Cell.Unloader'];
        } else if (process === 'D-Stacking') {
            options = ['-', '[01]Cell.Loading C/V', '[02]Cell.Loading C/V', '[01]Cell.Stacker', '[02]Cell.Stacker', '[03]Cell.Stacker', 'Stacked Cell.Transfer'];
        } else if (process === 'Taper') {
            options = ['-', 'HalfCell.Loading', 'HalfCell.Stack', 'LMS', '[01]StackedCell.Taper', '[02]StackedCell.Taper'];
        } else if (process === 'Inspection') {
            options = ['-', 'TapedCell.Vision', 'TapedCell.Rotate', 'TapedCell.ShortInspector', 'Cell.TrackingSystem', 'TapedCell.Transfer', 'TapedCell.Unloader'];
        }
        else {
            options = ['Í∏∞ÌÉÄ']; // Í∏∞Î≥∏Í∞í ÎòêÎäî Í≥µÏ†ï Ïô∏ Ìï≠Î™© Ï≤òÎ¶¨
        }
    }

    options.forEach(function (opt) {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        unitSelect.appendChild(option);
    });
});

// para-assy Ïó∞Îèô (UnitÏóê Îî∞Îùº Assy ÏÑ§Ï†ï)
document.getElementById('para-unit').addEventListener('change', function () {
    const site = document.getElementById('para-site').value;
    const unit = this.value;
    const assySelect = document.getElementById('para-assy');
    assySelect.innerHTML = '';

    let options = [];
    if (site == 'MI1' || site === 'WA5') {
        if (unit === 'Electrode.Unwinder') {
            options = [
            '-', '[01] Electrode. Unwinder', '[02] Electrode. Unwinder',
            '[01] Pancake. Air Chuck', '[02] Pancake. Air Chuck',
            '[01] Electrode. Spool EPC', '[02] Electrode. Spool EPC',
            '[01] Electrode. Splicer', '[02] Electrode. Splicer',
            '[01] Door', '[02] Door'
            ];
        }
        else if (unit === 'Separator.Unwinder') {
            options = [
            '-', '[01/Upper] Separator. Unwinder', '[02/Upper] Separator. Unwinder',
            '[01/Upper] Separator. Winder', '[02/Upper] Separator. Winder',
            '[01/Lower] Separator. Unwinder', '[02/Lower] Separator. Unwinder',
            '[01/Lower] Separator. Winder', '[02/Lower] Separator. Winder',
            '[02/Upper] Pancake. Air Chuck', '[03/Upper] Pancake. Air Chuck',
            '[02/Lower] Pancake. Air Chuck', '[03/Lower] Pancake. Air Chuck',
            '[01/Upper] Pancake. Air Chuck', '[04/Upper] Pancake. Air Chuck',
            '[01/Lower] Pancake. Air Chuck', '[04/Lower] Pancake. Air Chuck',
            '[01/Upper] Separator. Splicer', '[02/Upper] Separator. Splicer',
            '[01/Lower] Separator. Splicer', '[02/Lower] Separator. Splicer'
            ];
        }
        else if (unit === 'Electrode/Separator.Combiner') {
            options = [
            '-', '[Upper] Electrode. Conveyor', '[Center] Electrode. Conveyor', '[Lower] Electrode. Conveyor',
            '[01] Electrode / Separator. Combiner Conveyor', '[02] Electrode / Separator. Combiner Conveyor',
            '[Upper] Electrode. EPC', '[Center] Electrode. EPC', '[Lower] Electrode. EPC',
            '[Upper] Separator. EPC', '[Lower] Separator. EPC',
            '[Upper] Electrode. Cutter', '[Center] Electrode. Cutter', '[Lower] Electrode. Cutter',
            'Electrode. Dancer', '[Upper] Separator. Dancer', '[Lower] Separator. Dancer',
            '[01/Upper] PET (Separator). Dancer', '[02/Upper] PET (Separator). Dancer',
            '[01/Lower] PET (Separator). Dancer', '[02/Lower] PET (Separator). Dancer',
            '[Upper] Electrode. Cutting Linear', '[Center] Electrode. Cutting Linear', '[Lower] Electrode. Cutting Linear'
            ];
        }
        else if (unit === 'Laminator') {
            options = [
            '-', '[Upper] Heater', '[Lower] Heater',
            '[Upper] Sub Heater', '[Lower] Sub Heater',
            '[Upper] Lamination Roller', '[Lower] Lamination Roller',
            '[Upper] PET. Cleaner', '[Lower] PET. Cleaner',
            '[01/Upper] PET. Dancer', '[01/Lower] PET. Dancer',
            '[02/Upper] PET. Dancer', '[02/Lower] PET. Dancer',
            '[Upper] PET. Unwinder', '[Lower] PET. Unwinder',
            '[Upper] PET. Winder', '[Lower] PET. Winder',
            'Uncut Cell. Dancer', '[Upper] PET. Splicer', '[Lower] PET. Splicer',
            'Separator. Sealer', 'Separator. Sealing Linear'
            ];
        }
        else if (unit === 'Final Cell Cutter') {
            options = [
            '-', 'Uncut Cell. Conveyor', 'Cell. Conveyor',
            'Cell. Cutter', 'Electrode. Cutting Linear'
            ];
        }
        else if (unit === 'Cell.Inspector') {
            options = [
            '-', 'Cell. Conveyor', 'Cell. Gripper',
            '[01] Cell. Vision Inspector', 'Cell. Short Inspector',
            '[02] Cell. Vision Inspector', 'Cell. Linear'
            ];
        }
        else if (unit === 'Cell.Unloader') {
            options = [
            '-', '[01] Cell. Pusher', '[02] Cell. Pusher',
            '[01] NG Cell. Ejector', '[02] NG Cell. Ejector', '[03] NG Cell. Ejector',
            'Cell. Suction Conveyor', '[01] Cell. Buffer Lift', '[02] Cell. Buffer Lift'
            ];
        }
        else if (unit === 'Magazine Buffer') {
            options = [
            '-', '[01] Magazine. Lift', '[02] Magazine. Lift',
            '[01A] Magazine. Conveyor', '[01B] Magazine. Conveyor',
            '[02A] Magazine. Conveyor', '[02B] Magazine. Conveyor'
            ];
        }
        else if (unit === 'Cell.Conveyor') {
            options = ['-', 'Cell. Suction Conveyor'];
        }
        else if (unit === 'Cell.Distributor') {
            options = [
            '-', 'Cell. Pick & Place (Delta)',
            '[A] Cell. Suction Conveyor', '[B] Cell. Suction Conveyor'
            ];
        }
        else if (unit === 'Cell.Aligner') {
            options = [
            '-', '[A] Cell. Gripper', '[B] Cell. Gripper', '[A] Cell. Vision',
            '[C] Cell. Gripper', '[D] Cell. Gripper', '[B] Cell. Vision'
            ];
        }
        else if (unit === 'Cell.Stacking Table') {
            options = [
            '-', '[A] Cell. Vision', '[B] Cell. Vision',
            '[1A] Stacking Table', '[2A] Stacking Table', '[1B] Stacking Table', '[2B] Stacking Table',
            '[1A] Finger Clamp', '[1B] Finger Clamp', '[1C] Finger Clamp', '[1D] Finger Clamp',
            '[2A] Finger Clamp', '[2B] Finger Clamp', '[2C] Finger Clamp', '[2D] Finger Clamp',
            '[1A] Cell. Lift', '[2A] Cell. Lift', '[1B] Cell. Lift', '[2B] Cell. Lift'
            ];
        }
        else if (unit === 'Stacked Cell.Transfer') {
            options = [
            '-', '[A] Stacked Cell. Transfer', '[B] Stacked Cell. Transfer',
            '[A] Stacked Cell. Gripper', '[B] Stacked Cell. Gripper'
            ];
        }
        else if (unit === 'Stacked Cell.Loader') {
            options = [
            '-', '[A] Air. Supply', '[B] Air. Supply',
            '[A] Stacked Cell. Rotating Table', '[B] Stacked Cell. Rotating Table',
            '[A] Stacked Cell. Transfer', '[B] Stacked Cell. Transfer'
            ];
        }
        else if (unit === 'LMS') {
            options = ['-', 'Stacked Cell. Shuttle', 'Stacked Cell. Clamp'];
        }
        else if (unit === 'Half Cell.Stacker') {
            options = [
            '-', 'Air. Supply', '[Upper] Half Cell. Vision', '[Lower] Half Cell. Vision',
            'SCARA Robot', 'Half Cell. Pick&Place',
            '[01] Half Cell. Lift', '[02] Half Cell. Lift',
            '[01] Half Cell. Rotating Table', '[02] Half Cell. Rotating Table', 'Half Cell. Table'
            ];
        }
        else if (unit === 'Stacked Cell.Taper') {
            options = [
            '-', '[01] Stacked Cell. Press', '[02] Stacked Cell. Press',
            '[A] Tape. Attacher', '[B] Tape. Attacher',
            '[1A] Tape. Feeder', '[2A] Tape. Feeder', '[3A] Tape. Feeder',
            '[1B] Tape. Feeder', '[2B] Tape. Feeder', '[3B] Tape. Feeder',
            '[1A] Tape. Clamp', '[2A] Tape. Clamp', '[3A] Tape. Clamp',
            '[1B] Tape. Clamp', '[2B] Tape. Clamp', '[3B] Tape. Clamp'
            ];
        }
        else if (unit === 'Stacked Cell.Unloader') {
            options = ['-', 'Air. Supply', 'Taped Cell. Lift'];
        }
        else if (unit === 'Taped Cell.Vision') {
            options = [
            '-', 'Taped Cell. Pick&Place', '[Upper] Taped Cell. Vision',
            '[Lower] Taped Cell. Vision', 'Taped Cell. Transfer'
            ];
        }
        else if (unit === 'Taped Cell.Weight Inspector') {
            options = ['-', 'Taped Cell. Pick&Place', '[Upper] Taped Cell. Weight Inspector'];
        }
        else if (unit === 'Taped Cell.Short hecker') {
            options = [
            '-', 'Taped Cell. Dual Transfer', 'Taped Cell. Short Checker',
            '[01] Taped Cell. Table', '[02] Taped Cell. Table'
            ];
        }
        else if (unit === 'Taped Cell.Transfer Unit') {
            options = [
            '-', 'Taped Cell. Pick&Place', 'NG Box (vision)', 'NG Box (weight)', 'NG Box (short)',
            'NG Box Lift (vision)', 'NG Box Lift (weight)', 'NG Box Lift (short)', 'OK Cell. Conveyor'
            ];
        }
        else if (unit === 'Taped Cell.Unloader') {
            options = ['-', 'Taped Cell. Pick&Place', 'Taped Cell. Conveyor', 'Tray. Conveyor', 'Tray (Empty). Conveyor'];
        }
        else {
            options = ['-'];
        }
    }

    else {
        if (unit === 'Pancake.Loader') {
            options = ['-', '[01/A] Pancake. Conveyor', '[01/B] Pancake. Conveyor', '[01/C] Pancake. Conveyor', '[02/A] Pancake. Conveyor', '[02B] Pancake. Conveyor', '[02/C] Pancake. Conveyor', 'Pancake. Hoist', '[01/A] Pancake. Unwinder', '[02/A] Pancake. Unwinder', '[03/A] Pancake. Unwinder', '[04/A] Pancake. Unwinder', '[01/B] Pancake. Unwinder', '[02/B] Pancake. Unwinder', '[03/B] Pancake. Unwinder', '[04/B] Pancake. Unwinder', '[01/A] Electrode. Vacuum Plate', '[02/A] Electrode. Vacuum Plate', '[03/A] Electrode. Vacuum Plate', '[04/A] Electrode. Vacuum Plate', '[01/B] Electrode. Vacuum Plate', '[02/B] Electrode. Vacuum Plate', '[03/B] Electrode. Vacuum Plate', '[04/B] Electrode. Vacuum Plate', '[01/A] Electrode. Auto Splicer Cutter', '[02/A] Electrode. Auto Splicer Cutter', '[03/A] Electrode. Auto Splicer Cutter', '[04/A] Electrode. Auto Splicer Cutter', '[01/B] Electrode. Auto Splicer Cutter', '[02/B] Electrode. Auto Splicer Cutter', '[03/B] Electrode. Auto Splicer Cutter', '[04/B] Electrode. Auto Splicer Cutter', 'Electrode. Tape Feeder', 'Electrode. Scrape Box', '[01/A] Electrode. Idle Roller', '[02/A] Electrode. Idle Roller', '[01/B] Electrode. Idle Roller', '[02/B] Electrode. Idle Roller', '[01/A] Dancer. Roller', '[02/A] Dancer. Roller', '[01/B] Dancer. Roller', '[02/B] Dancer. Roller', '[01/A] Adjust Roller', '[02/A] Adjust Roller', '[01/B] Adjust Roller', '[02/B] Adjust Roller', '[01/A] Electrode. EPC', '[02/A] Electrode. EPC', '[03/A] Electrode. EPC', '[04/A] Electrode. EPC', '[01/B] Electrode. EPC', '[02/B] Electrode. EPC', '[03/B] Electrode. EPC', '[04/B] Electrode. EPC', '[01/A] Winder Diameter Sensor', '[02/A] Winder Diameter Sensor', '[03/A] Winder Diameter Sensor', '[04/A] Winder Diameter Sensor', '[01/B] Winder Diameter Sensor', '[02/B] Winder Diameter Sensor', '[03/B] Winder Diameter Sensor', '[04/B] Winder Diameter Sensor', '[01/A] PET tape sensor', '[02/A] PET tape sensor', '[03/A] PET tape sensor', '[04/A] PET tape sensor', '[01/B] PET tape sensor', '[02/B] PET tape sensor', '[03/B] PET tape sensor', '[04/B] PET tape sensor', '[01] Tab Direction Vision', '[02] Tab Direction Vision', 'ATR'];
        } else if (unit === 'Separator. Unwinder') {
            options = ['-', '[01/Upper] Separator. Unwinder', '[02/Upper] Separator. Unwinder', '[01/Upper] Separator. PET. Winder', '[02/Upper] Separator. PET. Winder', '[01/Lower] Separator. Unwinder', '[02/Lower] Separator. Unwinder', '[01/Lower] Separator. PET. Winder', '[02/Lower] Separator. PET. Winder', '[01/Upper] Separator. PET. Ionizer', '[02/Upper] Separator. PET. Ionizer', '[01/Lower] Separator. PET. Ionizer', '[02/Lower] Separator. PET. Ionizer', '[01/Upper] Separator. Auto Splicer Vacuum Plate', '[02/Upper] Separator. Auto Splicer Vacuum Plate', '[03/Upper] Separator. Auto Splicer Vacuum Plate', '[04/Upper] Separator. Auto Splicer Vacuum Plate', '[Upper] Separator. Auto Splicer Tape feeder', '[Upper] Separator. Auto Splicer Tape clamp', '[Upper] Separator. Auto Splicer Cutter', '[Upper] Separator. Auto Splicer Residual Sepa collector', '[Upper] Separator. Auto Splicer Residual Sepa collector', '[01/Lower] Separator. Auto Splicer vacuum plate', '[02/Lower] Separator. Auto Splicer vacuum plate', '[03/Lower] Separator. Auto Splicer  vacuum plate', '[04/Lower] Separator. Auto Splicer  vacuum plate', '[Lower] Separator. Auto Splicer Tape feeder', '[Lower] Separator. Auto Splicer Tape clamp', '[Lower] Separator. Auto Splicer Separator cutter', '[Lower ] Separator. Auto Splicer Residual Sepa collector', '[Lower] Separator. Auto Splicer Residual Sepa collector', '[01/Upper] Electrode. Manual Splicer', '[01/Center] Electrode. Manual Splicer', '[01/Upper] Separator. Winder Diameter Sensor', '[02/Upper] Separator. Winder Diameter Sensor', '[01/Lower] Separator. Winder Diameter Sensor', '[02/Lower] Separator. Winder Diameter Sensor', '[01/Upper] Separator. End Tape Sensor', '[02/Upper] Separator. End Tape Sensor', '[01/Lower] Separator. End Tape Sensor', '[02/Lower] Separator. End Tape Sensor', '[Upper] Separator. Manual Splicer', '[Lower] Separator. Manual Splicer'];
        } else if (unit === 'Electrode/Separator.Combiner') {
            options = ['-', '[Upper] Electrode. Feeding Roller', '[Center] Electrode. Feeding Roller', '[01] Electrode / Separator. Nip Roller', '[01] Electrode / Separator. Temporary Heating Roller', '[02] Electrode / Separator. Nip Roller', '[02] Electrode / Separator. Temporary Heating Roller', '[Upper] Electrode. EPC', '[Center] Electrode. EPC', '[Upper] Separator. EPC', '[Lower] Separator. EPC', '[Upper] Electrode. Cutter', '[Center] Electrode. Cutter', '[Upper] Electrode Cutting Linear', '[Center] Electrode Cutting Linear', '[Upper] Separator. Dancer', '[Lower] Separator. Dancer', '[Lower] Separator. Corona(not applied)', '[Upper] Electrode. Idle Roller', '[Center] Electrode. Idle Roller', '[Upper] Separator. Idle Roller', '[Lower] Separator. Idle Roller', '[Upper] PET (Separator). Idle Roller', '[Lower] PET (Separator). Idle Roller', 'Magnet', '[02/Upper] Electrode. Manual Splicer', '[02/Center] Electrode. Manual Splicer', '[Upper] Electrode Connection PET Winder', '[Center] Electrode. V Groove Vision', '[Upper] Electrode. Connection Tape Sensor', '[Center] Electrode. Connection Tape Sensor', '[Upper] Separator. Connection Tape Sensor', '[Lower] Separator. Connection Tape Sensor', '[Upper] Electrode. Stopper', '[Center] Electrode. Stopper', '[Upper] Separator. KANSEN Expander Roller', '[Lower] Separator. KANSEN Expander Roller'];
        } else if (unit === 'Laminator') {
            options = ['-', '[01/Upper] Heating Zone', '[01/Lower] Heating Zone', '[Upper] Sub Heater', '[Lower] Sub Heater', '[Upper] Lamination Roller', '[Lower] Lamination Roller', '[a] PET. Cleaner', '[b] PET. Cleaner', '[c] PET. Cleaner', '[d] PET. Cleaner', '[01/Upper] PET. Dancer', '[02/Upper] PET. Dancer', '[01/Lower] PET. Dancer', '[02/Lower] PET. Dancer', '[Upper] PET. Unwinder', '[Lower] PET. Unwinder', '[Upper] PET. Winder', '[Lower] PET. Winder', 'Uncut Cell. Dancer', '[Upper] PET. Splicer(Manual)', '[Lower] PET. Splicer(Manual)', 'Separator. Sealer', 'Separator. Sealing Linear', 'Uncut Cell. Air Blow/Suction', 'Uncut Cell. Union Vision (#Ìï©Ïπò)', '[01/Upper] PET. Ionizer', '[02/Upper] PET. Ionizer', '[01/Lower] PET. Ionizer', '[02/Lower] PET. Ionizer', '[Upper] PET. Idle Roller', '[Lower] PET. Idle Roller', 'Magnet', '[Upper] Separator. Longside Sealer', '[Lower] Separator. Longside Sealer', 'Separator. Longside Sealer. Vision', '[Upper] Sub Roller', '[Lower] Sub Roller', 'Particle Prevention Unit'];
        } else if (unit === 'Cell.FinalCutter') {
            options = ['-', 'Uncut Cell. Conveyor', 'Cell. Grip Nip Roller', 'Cell. Cutter', 'Electrode. Cutting Linear'];
        } else if (unit === 'Cell.TrackingSystem') {
            options = ['-', 'Cell. BCR'];
        } else if (unit === 'Cell.Inspector') {
            options = ['-', 'Cell. Suction Conveyor', 'Cell. Short Inspector', 'Cell. Vision Inspector', 'Cell. NG Mark Vision', 'Cell. Short Inspector Linear', 'Cell. Vision Inspector Linear', 'Cell. Blow & Suction', 'Cell. Thickness Sensor'];
        } else if (unit === 'Cell.Unloader') {
            options = ['-', '[01] NG Cell. Pusher', '[02] NG Cell. Pusher', '[03] NG Cell. Pusher', '[01] NG Cell. Box', '[02] NG Cell. Box', '[03] NG Cell. Box', 'Cell. Suction Conveyor', 'OK Cell. Pusher'];
        } else if (unit === '[01]Cell.Loading C/V') {
            options = ['-', '[Lower] Cell. Loading C/V'];
        } else if (unit === '[02]Cell.Loading C/V') {
            options = ['-', '[Upper] Cell. Loading C/V', '[01] Cell. NG Box', '[02] Cell. NG Box', 'Cell. Lower Separator Vision'];
        } else if (unit === '[01]Cell.Stacker') {
            options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
        } else if (unit === '[02]Cell.Stacker') {
            options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
        } else if (unit === '[03]Cell.Stacker') {
            options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
        } else if (unit === 'Stacked Cell.Transfer') {
            options = ['-', 'Stacked Cell. Transfer', 'Stacked Cell. Gripper'];
        } else if (unit === 'HalfCell.Loading') {
            options = ['-', '[A] Half Cell. Magazine', '[B] Half Cell. Magazine', '[C] Half Cell. Magazine', 'Half Cell. Vibrator', 'Half Cell. Pick & Place', 'Half Cell. Thickness Inspector', 'Half Cell. Rotate', '[A] Half Cell. NG Box', '[B] Half Cell. NG Box'];
        } else if (unit === 'HalfCell.Stack') {
            options = ['-', 'Half Cell. Buffer Table', 'Half Cell. Vision NG Box', 'Half Cell. Scara Robot', 'Half Cell. Vision'];
        } else if (unit === 'LMS') {
            options = ['-', 'Stacked Cell. Shuttle', '[01] LMS. Stacked Cell Clamp Air Supply', '[02] LMS. Stacked Cell Clamp Air Supply', '[03] LMS. Stacked Cell Clamp Air Supply', '[04] LMS. Stacked Cell Clamp Air Supply', '[05] LMS. Stacked Cell Clamp Air Supply', 'Shuttle. In Lift', 'Shuttle. Out Lift', 'Shuttle. Blow & Suction Cleaner', 'Shuttle. Buffer01', 'Shuttle. Buffer02', 'Stacked Cell. NG Pick & Place', 'Stacked Cell. NG Box', 'Stacked Cell. Rotate', 'Stacked Cell. BCR'];
        } else if (unit === '[01]StackedCell.Taper') {
            options = ['-', 'Stacked Cell. Press', '[01] Tape. Attacher', '[02] Tape. Attacher', '[03] Tape. Attacher', '[04] Tape. Attacher', '[05] Tape. Attacher', '[06] Tape. Attacher', '[01] Tape. Upper Clamp', '[02] Tape. Upper Clamp', '[03] Tape. Upper Clamp', '[04] Tape. Upper Clamp', '[05] Tape. Upper Clamp', '[06] Tape. Upper Clamp', '[01] Tape. Lower Clamp', '[02] Tape. Lower Clamp', '[03] Tape. Lower Clamp', '[04] Tape. Lower Clamp', '[05] Tape. Lower Clamp', '[06] Tape. Lower Clamp', '[01] Tape. Tape Supply', '[02] Tape. Tape Supply', '[03] Tape. Tape Supply', '[04] Tape. Tape Supply', '[05] Tape. Tape Supply', '[06] Tape. Tape Supply', '[01] Tape. Cutter', '[02] Tape. Cutter', '[03] Tape. Cutter', '[04] Tape. Cutter', '[05] Tape. Cutter', '[06] Tape. Cutter', 'NG Tape. Receiver'];
        } else if (unit === '[02]StackedCell.Taper') {
            options = ['-', 'Stacked Cell. Press', '[01] Tape. Attacher', '[02] Tape. Attacher', '[03] Tape. Attacher', '[04] Tape. Attacher', '[05] Tape. Attacher', '[06] Tape. Attacher', '[01] Tape. Upper Clamp', '[02] Tape. Upper Clamp', '[03] Tape. Upper Clamp', '[04] Tape. Upper Clamp', '[05] Tape. Upper Clamp', '[06] Tape. Upper Clamp', '[01] Tape. Lower Clamp', '[02] Tape. Lower Clamp', '[03] Tape. Lower Clamp', '[04] Tape. Lower Clamp', '[05] Tape. Lower Clamp', '[06] Tape. Lower Clamp', '[01] Tape. Tape Supply', '[02] Tape. Tape Supply', '[03] Tape. Tape Supply', '[04] Tape. Tape Supply', '[05] Tape. Tape Supply', '[06] Tape. Tape Supply', '[01] Tape. Cutter', '[02] Tape. Cutter', '[03] Tape. Cutter', '[04] Tape. Cutter', '[05] Tape. Cutter', '[06] Tape. Cutter', 'NG Tape. Receiver'];
        } else if (unit === 'TapedCell.Vision') {
            options = ['-', '[01] Taped Cell. Pick & Place', '[Upper/Lower] Taped Cell. Vision', '[4-side] Taped Cell. Vision', 'Taped Cell. Rotating Table', '[02] Taped Cell. Pick & Place', 'Taped Cell. Weight Inspector'];
        } else if (unit === 'TapedCell.Rotate') {
            options = ['-', 'TapedCell.Rotate'];
        } else if (unit === 'TapedCell.ShortInspector') {
            options = ['-', 'Taped Cell. Shuttle', 'Taped Cell. Short, Thickness Inspector'];
        } else if (unit === 'Cell.TrackingSystem') {
            options = ['-', '[01] Cell. BCR', '[02] Cell. BCR'];
        } else if (unit === 'TapedCell.Transfer') {
            options = ['-', 'NG Taped Cell. Transfer', '[01] NG Box', '[02] NG Box', '[03] NG Box', '[04] NG Box', 'NG Box Transfer', 'OK Taped Cell. Transfer', 'Taped Cell. Conveyor', 'Taped Cell. Align'];
        } else if (unit === 'TapedCell.Unloader') {
            options = ['-', 'Taped Cell. Pick & Place', '[01] Taped Cell. Lift', '[02] Taped Cell. Lift', '[01] Tray(Empty). Conveyor', '[02] Tray(Empty). Conveyor', 'Tray(Empty). Conveyor', 'Tray. Conveyor', '[A] Tray. Lift', '[B] Tray. Lift', 'Tray. Cleaner', 'Tray. Conveyor Free Roller', 'Tray(Empty). Conveyor Free Roller'];
        } else {
            options = ['-'];
        }
    }

    options.forEach(function (opt) {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        assySelect.appendChild(option);
    });
});

// trouble-assy Ïó∞Îèô (UnitÏóê Îî∞Îùº Assy ÏÑ§Ï†ï)
document.getElementById('trouble-unit').addEventListener('change', function () {
    const site = document.getElementById('trouble-site').value;
    const unit = this.value;
    const assySelect = document.getElementById('trouble-assy');
    assySelect.innerHTML = '';

    let options = [];

    if (site == 'MI1' || site == 'WA5') {
        if (unit === 'Electrode.Unwinder') {
            options = [
            '-', '[01] Electrode. Unwinder', '[02] Electrode. Unwinder',
            '[01] Pancake. Air Chuck', '[02] Pancake. Air Chuck',
            '[01] Electrode. Spool EPC', '[02] Electrode. Spool EPC',
            '[01] Electrode. Splicer', '[02] Electrode. Splicer',
            '[01] Door', '[02] Door'
            ];
        }
        else if (unit === 'Separator.Unwinder') {
            options = [
            '-', '[01/Upper] Separator. Unwinder', '[02/Upper] Separator. Unwinder',
            '[01/Upper] Separator. Winder', '[02/Upper] Separator. Winder',
            '[01/Lower] Separator. Unwinder', '[02/Lower] Separator. Unwinder',
            '[01/Lower] Separator. Winder', '[02/Lower] Separator. Winder',
            '[02/Upper] Pancake. Air Chuck', '[03/Upper] Pancake. Air Chuck',
            '[02/Lower] Pancake. Air Chuck', '[03/Lower] Pancake. Air Chuck',
            '[01/Upper] Pancake. Air Chuck', '[04/Upper] Pancake. Air Chuck',
            '[01/Lower] Pancake. Air Chuck', '[04/Lower] Pancake. Air Chuck',
            '[01/Upper] Separator. Splicer', '[02/Upper] Separator. Splicer',
            '[01/Lower] Separator. Splicer', '[02/Lower] Separator. Splicer'
            ];
        }
        else if (unit === 'Electrode/Separator.Combiner') {
            options = [
            '-', '[Upper] Electrode. Conveyor', '[Center] Electrode. Conveyor', '[Lower] Electrode. Conveyor',
            '[01] Electrode / Separator. Combiner Conveyor', '[02] Electrode / Separator. Combiner Conveyor',
            '[Upper] Electrode. EPC', '[Center] Electrode. EPC', '[Lower] Electrode. EPC',
            '[Upper] Separator. EPC', '[Lower] Separator. EPC',
            '[Upper] Electrode. Cutter', '[Center] Electrode. Cutter', '[Lower] Electrode. Cutter',
            'Electrode. Dancer', '[Upper] Separator. Dancer', '[Lower] Separator. Dancer',
            '[01/Upper] PET (Separator). Dancer', '[02/Upper] PET (Separator). Dancer',
            '[01/Lower] PET (Separator). Dancer', '[02/Lower] PET (Separator). Dancer',
            '[Upper] Electrode. Cutting Linear', '[Center] Electrode. Cutting Linear', '[Lower] Electrode. Cutting Linear'
            ];
        }
        else if (unit === 'Laminator') {
            options = [
            '-', '[Upper] Heater', '[Lower] Heater',
            '[Upper] Sub Heater', '[Lower] Sub Heater',
            '[Upper] Lamination Roller', '[Lower] Lamination Roller',
            '[Upper] PET. Cleaner', '[Lower] PET. Cleaner',
            '[01/Upper] PET. Dancer', '[01/Lower] PET. Dancer',
            '[02/Upper] PET. Dancer', '[02/Lower] PET. Dancer',
            '[Upper] PET. Unwinder', '[Lower] PET. Unwinder',
            '[Upper] PET. Winder', '[Lower] PET. Winder',
            'Uncut Cell. Dancer', '[Upper] PET. Splicer', '[Lower] PET. Splicer',
            'Separator. Sealer', 'Separator. Sealing Linear'
            ];
        }
        else if (unit === 'Final Cell Cutter') {
            options = [
            '-', 'Uncut Cell. Conveyor', 'Cell. Conveyor',
            'Cell. Cutter', 'Electrode. Cutting Linear'
            ];
        }
        else if (unit === 'Cell.Inspector') {
            options = [
            '-', 'Cell. Conveyor', 'Cell. Gripper',
            '[01] Cell. Vision Inspector', 'Cell. Short Inspector',
            '[02] Cell. Vision Inspector', 'Cell. Linear'
            ];
        }
        else if (unit === 'Cell.Unloader') {
            options = [
            '-', '[01] Cell. Pusher', '[02] Cell. Pusher',
            '[01] NG Cell. Ejector', '[02] NG Cell. Ejector', '[03] NG Cell. Ejector',
            'Cell. Suction Conveyor', '[01] Cell. Buffer Lift', '[02] Cell. Buffer Lift'
            ];
        }
        else if (unit === 'Magazine Buffer') {
            options = [
            '-', '[01] Magazine. Lift', '[02] Magazine. Lift',
            '[01A] Magazine. Conveyor', '[01B] Magazine. Conveyor',
            '[02A] Magazine. Conveyor', '[02B] Magazine. Conveyor'
            ];
        }
        else if (unit === 'Cell.Conveyor') {
            options = ['-', 'Cell. Suction Conveyor'];
        }
        else if (unit === 'Cell.Distributor') {
            options = [
            '-', 'Cell. Pick & Place (Delta)',
            '[A] Cell. Suction Conveyor', '[B] Cell. Suction Conveyor'
            ];
        }
        else if (unit === 'Cell.Aligner') {
            options = [
            '-', '[A] Cell. Gripper', '[B] Cell. Gripper', '[A] Cell. Vision',
            '[C] Cell. Gripper', '[D] Cell. Gripper', '[B] Cell. Vision'
            ];
        }
        else if (unit === 'Cell.Stacking Table') {
            options = [
            '-', '[A] Cell. Vision', '[B] Cell. Vision',
            '[1A] Stacking Table', '[2A] Stacking Table', '[1B] Stacking Table', '[2B] Stacking Table',
            '[1A] Finger Clamp', '[1B] Finger Clamp', '[1C] Finger Clamp', '[1D] Finger Clamp',
            '[2A] Finger Clamp', '[2B] Finger Clamp', '[2C] Finger Clamp', '[2D] Finger Clamp',
            '[1A] Cell. Lift', '[2A] Cell. Lift', '[1B] Cell. Lift', '[2B] Cell. Lift'
            ];
        }
        else if (unit === 'Stacked Cell.Transfer') {
            options = [
            '-', '[A] Stacked Cell. Transfer', '[B] Stacked Cell. Transfer',
            '[A] Stacked Cell. Gripper', '[B] Stacked Cell. Gripper'
            ];
        }
        else if (unit === 'Stacked Cell.Loader') {
            options = [
            '-', '[A] Air. Supply', '[B] Air. Supply',
            '[A] Stacked Cell. Rotating Table', '[B] Stacked Cell. Rotating Table',
            '[A] Stacked Cell. Transfer', '[B] Stacked Cell. Transfer'
            ];
        }
        else if (unit === 'LMS') {
            options = ['-', 'Stacked Cell. Shuttle', 'Stacked Cell. Clamp'];
        }
        else if (unit === 'Half Cell.Stacker') {
            options = [
            '-', 'Air. Supply', '[Upper] Half Cell. Vision', '[Lower] Half Cell. Vision',
            'SCARA Robot', 'Half Cell. Pick&Place',
            '[01] Half Cell. Lift', '[02] Half Cell. Lift',
            '[01] Half Cell. Rotating Table', '[02] Half Cell. Rotating Table', 'Half Cell. Table'
            ];
        }
        else if (unit === 'Stacked Cell.Taper') {
            options = [
            '-', '[01] Stacked Cell. Press', '[02] Stacked Cell. Press',
            '[A] Tape. Attacher', '[B] Tape. Attacher',
            '[1A] Tape. Feeder', '[2A] Tape. Feeder', '[3A] Tape. Feeder',
            '[1B] Tape. Feeder', '[2B] Tape. Feeder', '[3B] Tape. Feeder',
            '[1A] Tape. Clamp', '[2A] Tape. Clamp', '[3A] Tape. Clamp',
            '[1B] Tape. Clamp', '[2B] Tape. Clamp', '[3B] Tape. Clamp'
            ];
        }
        else if (unit === 'Stacked Cell.Unloader') {
            options = ['-', 'Air. Supply', 'Taped Cell. Lift'];
        }
        else if (unit === 'Taped Cell.Vision') {
            options = [
            '-', 'Taped Cell. Pick&Place', '[Upper] Taped Cell. Vision',
            '[Lower] Taped Cell. Vision', 'Taped Cell. Transfer'
            ];
        }
        else if (unit === 'Taped Cell.Weight Inspector') {
            options = ['-', 'Taped Cell. Pick&Place', '[Upper] Taped Cell. Weight Inspector'];
        }
        else if (unit === 'Taped Cell.Short hecker') {
            options = [
            '-', 'Taped Cell. Dual Transfer', 'Taped Cell. Short Checker',
            '[01] Taped Cell. Table', '[02] Taped Cell. Table'
            ];
        }
        else if (unit === 'Taped Cell.Transfer Unit') {
            options = [
            '-', 'Taped Cell. Pick&Place', 'NG Box (vision)', 'NG Box (weight)', 'NG Box (short)',
            'NG Box Lift (vision)', 'NG Box Lift (weight)', 'NG Box Lift (short)', 'OK Cell. Conveyor'
            ];
        }
        else if (unit === 'Taped Cell.Unloader') {
            options = ['-', 'Taped Cell. Pick&Place', 'Taped Cell. Conveyor', 'Tray. Conveyor', 'Tray (Empty). Conveyor'];
        }
        else {
            options = ['-'];
        }
    }
    else {
        if (unit === 'Pancake.Loader') {
            options = ['-', '[01/A] Pancake. Conveyor', '[01/B] Pancake. Conveyor', '[01/C] Pancake. Conveyor', '[02/A] Pancake. Conveyor', '[02B] Pancake. Conveyor', '[02/C] Pancake. Conveyor', 'Pancake. Hoist', '[01/A] Pancake. Unwinder', '[02/A] Pancake. Unwinder', '[03/A] Pancake. Unwinder', '[04/A] Pancake. Unwinder', '[01/B] Pancake. Unwinder', '[02/B] Pancake. Unwinder', '[03/B] Pancake. Unwinder', '[04/B] Pancake. Unwinder', '[01/A] Electrode. Vacuum Plate', '[02/A] Electrode. Vacuum Plate', '[03/A] Electrode. Vacuum Plate', '[04/A] Electrode. Vacuum Plate', '[01/B] Electrode. Vacuum Plate', '[02/B] Electrode. Vacuum Plate', '[03/B] Electrode. Vacuum Plate', '[04/B] Electrode. Vacuum Plate', '[01/A] Electrode. Auto Splicer Cutter', '[02/A] Electrode. Auto Splicer Cutter', '[03/A] Electrode. Auto Splicer Cutter', '[04/A] Electrode. Auto Splicer Cutter', '[01/B] Electrode. Auto Splicer Cutter', '[02/B] Electrode. Auto Splicer Cutter', '[03/B] Electrode. Auto Splicer Cutter', '[04/B] Electrode. Auto Splicer Cutter', 'Electrode. Tape Feeder', 'Electrode. Scrape Box', '[01/A] Electrode. Idle Roller', '[02/A] Electrode. Idle Roller', '[01/B] Electrode. Idle Roller', '[02/B] Electrode. Idle Roller', '[01/A] Dancer. Roller', '[02/A] Dancer. Roller', '[01/B] Dancer. Roller', '[02/B] Dancer. Roller', '[01/A] Adjust Roller', '[02/A] Adjust Roller', '[01/B] Adjust Roller', '[02/B] Adjust Roller', '[01/A] Electrode. EPC', '[02/A] Electrode. EPC', '[03/A] Electrode. EPC', '[04/A] Electrode. EPC', '[01/B] Electrode. EPC', '[02/B] Electrode. EPC', '[03/B] Electrode. EPC', '[04/B] Electrode. EPC', '[01/A] Winder Diameter Sensor', '[02/A] Winder Diameter Sensor', '[03/A] Winder Diameter Sensor', '[04/A] Winder Diameter Sensor', '[01/B] Winder Diameter Sensor', '[02/B] Winder Diameter Sensor', '[03/B] Winder Diameter Sensor', '[04/B] Winder Diameter Sensor', '[01/A] PET tape sensor', '[02/A] PET tape sensor', '[03/A] PET tape sensor', '[04/A] PET tape sensor', '[01/B] PET tape sensor', '[02/B] PET tape sensor', '[03/B] PET tape sensor', '[04/B] PET tape sensor', '[01] Tab Direction Vision', '[02] Tab Direction Vision', 'ATR'];
        } else if (unit === 'Separator. Unwinder') {
            options = ['-', '[01/Upper] Separator. Unwinder', '[02/Upper] Separator. Unwinder', '[01/Upper] Separator. PET. Winder', '[02/Upper] Separator. PET. Winder', '[01/Lower] Separator. Unwinder', '[02/Lower] Separator. Unwinder', '[01/Lower] Separator. PET. Winder', '[02/Lower] Separator. PET. Winder', '[01/Upper] Separator. PET. Ionizer', '[02/Upper] Separator. PET. Ionizer', '[01/Lower] Separator. PET. Ionizer', '[02/Lower] Separator. PET. Ionizer', '[01/Upper] Separator. Auto Splicer Vacuum Plate', '[02/Upper] Separator. Auto Splicer Vacuum Plate', '[03/Upper] Separator. Auto Splicer Vacuum Plate', '[04/Upper] Separator. Auto Splicer Vacuum Plate', '[Upper] Separator. Auto Splicer Tape feeder', '[Upper] Separator. Auto Splicer Tape clamp', '[Upper] Separator. Auto Splicer Cutter', '[Upper] Separator. Auto Splicer Residual Sepa collector', '[Upper] Separator. Auto Splicer Residual Sepa collector', '[01/Lower] Separator. Auto Splicer vacuum plate', '[02/Lower] Separator. Auto Splicer vacuum plate', '[03/Lower] Separator. Auto Splicer  vacuum plate', '[04/Lower] Separator. Auto Splicer  vacuum plate', '[Lower] Separator. Auto Splicer Tape feeder', '[Lower] Separator. Auto Splicer Tape clamp', '[Lower] Separator. Auto Splicer Separator cutter', '[Lower ] Separator. Auto Splicer Residual Sepa collector', '[Lower] Separator. Auto Splicer Residual Sepa collector', '[01/Upper] Electrode. Manual Splicer', '[01/Center] Electrode. Manual Splicer', '[01/Upper] Separator. Winder Diameter Sensor', '[02/Upper] Separator. Winder Diameter Sensor', '[01/Lower] Separator. Winder Diameter Sensor', '[02/Lower] Separator. Winder Diameter Sensor', '[01/Upper] Separator. End Tape Sensor', '[02/Upper] Separator. End Tape Sensor', '[01/Lower] Separator. End Tape Sensor', '[02/Lower] Separator. End Tape Sensor', '[Upper] Separator. Manual Splicer', '[Lower] Separator. Manual Splicer'];
        } else if (unit === 'Electrode/Separator.Combiner') {
            options = ['-', '[Upper] Electrode. Feeding Roller', '[Center] Electrode. Feeding Roller', '[01] Electrode / Separator. Nip Roller', '[01] Electrode / Separator. Temporary Heating Roller', '[02] Electrode / Separator. Nip Roller', '[02] Electrode / Separator. Temporary Heating Roller', '[Upper] Electrode. EPC', '[Center] Electrode. EPC', '[Upper] Separator. EPC', '[Lower] Separator. EPC', '[Upper] Electrode. Cutter', '[Center] Electrode. Cutter', '[Upper] Electrode Cutting Linear', '[Center] Electrode Cutting Linear', '[Upper] Separator. Dancer', '[Lower] Separator. Dancer', '[Lower] Separator. Corona(not applied)', '[Upper] Electrode. Idle Roller', '[Center] Electrode. Idle Roller', '[Upper] Separator. Idle Roller', '[Lower] Separator. Idle Roller', '[Upper] PET (Separator). Idle Roller', '[Lower] PET (Separator). Idle Roller', 'Magnet', '[02/Upper] Electrode. Manual Splicer', '[02/Center] Electrode. Manual Splicer', '[Upper] Electrode Connection PET Winder', '[Center] Electrode. V Groove Vision', '[Upper] Electrode. Connection Tape Sensor', '[Center] Electrode. Connection Tape Sensor', '[Upper] Separator. Connection Tape Sensor', '[Lower] Separator. Connection Tape Sensor', '[Upper] Electrode. Stopper', '[Center] Electrode. Stopper', '[Upper] Separator. KANSEN Expander Roller', '[Lower] Separator. KANSEN Expander Roller'];
        } else if (unit === 'Laminator') {
            options = ['-', '[01/Upper] Heating Zone', '[01/Lower] Heating Zone', '[Upper] Sub Heater', '[Lower] Sub Heater', '[Upper] Lamination Roller', '[Lower] Lamination Roller', '[a] PET. Cleaner', '[b] PET. Cleaner', '[c] PET. Cleaner', '[d] PET. Cleaner', '[01/Upper] PET. Dancer', '[02/Upper] PET. Dancer', '[01/Lower] PET. Dancer', '[02/Lower] PET. Dancer', '[Upper] PET. Unwinder', '[Lower] PET. Unwinder', '[Upper] PET. Winder', '[Lower] PET. Winder', 'Uncut Cell. Dancer', '[Upper] PET. Splicer(Manual)', '[Lower] PET. Splicer(Manual)', 'Separator. Sealer', 'Separator. Sealing Linear', 'Uncut Cell. Air Blow/Suction', 'Uncut Cell. Union Vision (#Ìï©Ïπò)', '[01/Upper] PET. Ionizer', '[02/Upper] PET. Ionizer', '[01/Lower] PET. Ionizer', '[02/Lower] PET. Ionizer', '[Upper] PET. Idle Roller', '[Lower] PET. Idle Roller', 'Magnet', '[Upper] Separator. Longside Sealer', '[Lower] Separator. Longside Sealer', 'Separator. Longside Sealer. Vision', '[Upper] Sub Roller', '[Lower] Sub Roller', 'Particle Prevention Unit'];
        } else if (unit === 'Cell.FinalCutter') {
            options = ['-', 'Uncut Cell. Conveyor', 'Cell. Grip Nip Roller', 'Cell. Cutter', 'Electrode. Cutting Linear'];
        } else if (unit === 'Cell.TrackingSystem') {
            options = ['-', 'Cell. BCR'];
        } else if (unit === 'Cell.Inspector') {
            options = ['-', 'Cell. Suction Conveyor', 'Cell. Short Inspector', 'Cell. Vision Inspector', 'Cell. NG Mark Vision', 'Cell. Short Inspector Linear', 'Cell. Vision Inspector Linear', 'Cell. Blow & Suction', 'Cell. Thickness Sensor'];
        } else if (unit === 'Cell.Unloader') {
            options = ['-', '[01] NG Cell. Pusher', '[02] NG Cell. Pusher', '[03] NG Cell. Pusher', '[01] NG Cell. Box', '[02] NG Cell. Box', '[03] NG Cell. Box', 'Cell. Suction Conveyor', 'OK Cell. Pusher'];
        } else if (unit === '[01]Cell.Loading C/V') {
            options = ['-', '[Lower] Cell. Loading C/V'];
        } else if (unit === '[02]Cell.Loading C/V') {
            options = ['-', '[Upper] Cell. Loading C/V', '[01] Cell. NG Box', '[02] Cell. NG Box', 'Cell. Lower Separator Vision'];
        } else if (unit === '[01]Cell.Stacker') {
            options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
        } else if (unit === '[02]Cell.Stacker') {
            options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
        } else if (unit === '[03]Cell.Stacker') {
            options = ['-', 'Cell. Pusher', '[01/A] Cell. Gripper', '[02/A] Cell. Gripper', '[03/A] Cell. Gripper', '[01/B] Cell. Gripper', '[02/B] Cell. Gripper', '[03/B] Cell. Gripper', 'Cell. Align Vision', 'Cell. Align Table', 'Table Transfer Linear', 'Cell. Stack Vision'];
        } else if (unit === 'Stacked Cell.Transfer') {
            options = ['-', 'Stacked Cell. Transfer', 'Stacked Cell. Gripper'];
        } else if (unit === 'HalfCell.Loading') {
            options = ['-', '[A] Half Cell. Magazine', '[B] Half Cell. Magazine', '[C] Half Cell. Magazine', 'Half Cell. Vibrator', 'Half Cell. Pick & Place', 'Half Cell. Thickness Inspector', 'Half Cell. Rotate', '[A] Half Cell. NG Box', '[B] Half Cell. NG Box'];
        } else if (unit === 'HalfCell.Stack') {
            options = ['-', 'Half Cell. Buffer Table', 'Half Cell. Vision NG Box', 'Half Cell. Scara Robot', 'Half Cell. Vision'];
        } else if (unit === 'LMS') {
            options = ['-', 'Stacked Cell. Shuttle', '[01] LMS. Stacked Cell Clamp Air Supply', '[02] LMS. Stacked Cell Clamp Air Supply', '[03] LMS. Stacked Cell Clamp Air Supply', '[04] LMS. Stacked Cell Clamp Air Supply', '[05] LMS. Stacked Cell Clamp Air Supply', 'Shuttle. In Lift', 'Shuttle. Out Lift', 'Shuttle. Blow & Suction Cleaner', 'Shuttle. Buffer01', 'Shuttle. Buffer02', 'Stacked Cell. NG Pick & Place', 'Stacked Cell. NG Box', 'Stacked Cell. Rotate', 'Stacked Cell. BCR'];
        } else if (unit === '[01]StackedCell.Taper') {
            options = ['-', 'Stacked Cell. Press', '[01] Tape. Attacher', '[02] Tape. Attacher', '[03] Tape. Attacher', '[04] Tape. Attacher', '[05] Tape. Attacher', '[06] Tape. Attacher', '[01] Tape. Upper Clamp', '[02] Tape. Upper Clamp', '[03] Tape. Upper Clamp', '[04] Tape. Upper Clamp', '[05] Tape. Upper Clamp', '[06] Tape. Upper Clamp', '[01] Tape. Lower Clamp', '[02] Tape. Lower Clamp', '[03] Tape. Lower Clamp', '[04] Tape. Lower Clamp', '[05] Tape. Lower Clamp', '[06] Tape. Lower Clamp', '[01] Tape. Tape Supply', '[02] Tape. Tape Supply', '[03] Tape. Tape Supply', '[04] Tape. Tape Supply', '[05] Tape. Tape Supply', '[06] Tape. Tape Supply', '[01] Tape. Cutter', '[02] Tape. Cutter', '[03] Tape. Cutter', '[04] Tape. Cutter', '[05] Tape. Cutter', '[06] Tape. Cutter', 'NG Tape. Receiver'];
        } else if (unit === '[02]StackedCell.Taper') {
            options = ['-', 'Stacked Cell. Press', '[01] Tape. Attacher', '[02] Tape. Attacher', '[03] Tape. Attacher', '[04] Tape. Attacher', '[05] Tape. Attacher', '[06] Tape. Attacher', '[01] Tape. Upper Clamp', '[02] Tape. Upper Clamp', '[03] Tape. Upper Clamp', '[04] Tape. Upper Clamp', '[05] Tape. Upper Clamp', '[06] Tape. Upper Clamp', '[01] Tape. Lower Clamp', '[02] Tape. Lower Clamp', '[03] Tape. Lower Clamp', '[04] Tape. Lower Clamp', '[05] Tape. Lower Clamp', '[06] Tape. Lower Clamp', '[01] Tape. Tape Supply', '[02] Tape. Tape Supply', '[03] Tape. Tape Supply', '[04] Tape. Tape Supply', '[05] Tape. Tape Supply', '[06] Tape. Tape Supply', '[01] Tape. Cutter', '[02] Tape. Cutter', '[03] Tape. Cutter', '[04] Tape. Cutter', '[05] Tape. Cutter', '[06] Tape. Cutter', 'NG Tape. Receiver'];
        } else if (unit === 'TapedCell.Vision') {
            options = ['-', '[01] Taped Cell. Pick & Place', '[Upper/Lower] Taped Cell. Vision', '[4-side] Taped Cell. Vision', 'Taped Cell. Rotating Table', '[02] Taped Cell. Pick & Place', 'Taped Cell. Weight Inspector'];
        } else if (unit === 'TapedCell.Rotate') {
            options = ['-', 'TapedCell.Rotate'];
        } else if (unit === 'TapedCell.ShortInspector') {
            options = ['-', 'Taped Cell. Shuttle', 'Taped Cell. Short, Thickness Inspector'];
        } else if (unit === 'Cell.TrackingSystem') {
            options = ['-', '[01] Cell. BCR', '[02] Cell. BCR'];
        } else if (unit === 'TapedCell.Transfer') {
            options = ['-', 'NG Taped Cell. Transfer', '[01] NG Box', '[02] NG Box', '[03] NG Box', '[04] NG Box', 'NG Box Transfer', 'OK Taped Cell. Transfer', 'Taped Cell. Conveyor', 'Taped Cell. Align'];
        } else if (unit === 'TapedCell.Unloader') {
            options = ['-', 'Taped Cell. Pick & Place', '[01] Taped Cell. Lift', '[02] Taped Cell. Lift', '[01] Tray(Empty). Conveyor', '[02] Tray(Empty). Conveyor', 'Tray(Empty). Conveyor', 'Tray. Conveyor', '[A] Tray. Lift', '[B] Tray. Lift', 'Tray. Cleaner', 'Tray. Conveyor Free Roller', 'Tray(Empty). Conveyor Free Roller'];
        } else {
            options = ['-'];
        }
    }

    options.forEach(function (opt) {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        assySelect.appendChild(option);
    });
});

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÌòÑÏû¨ ÏãúÍ∞Ñ ÏÑ§Ï†ï
        window.onload = function() {
            setCurrentDateTime('para-time');
            setCurrentDateTime('trouble-time');
            setCurrentDateTime('trouble-complete');
        };

        // 1) ÏöîÏÜå Ï∞∏Ï°∞
        const startEl    = document.getElementById('trouble-time');
        const completeEl = document.getElementById('trouble-complete');

        // 2) ÌòÑÏû¨ ÏãúÍ∞Å Í∏∞Ï§Ä +1Ïùº(24h) Í≥ÑÏÇ∞ Ìï®Ïàò
        function getMaxIso() {
            const now     = new Date();
            const plusOne = new Date(now.getTime() + 24*60*60*1000);
            // datetime-local Ïóê ÎßûÏ∂ò ÌòïÏãù: YYYY-MM-DDThh:mm
            return plusOne.toISOString().slice(0,16);
        }

        // 3) max ÏÜçÏÑ± Í∞±Ïã† Î∞è Í∞í Î≥¥Ï†ï Ìï®Ïàò
        function updateMaxConstraints() {
            const maxIso = getMaxIso();

            // ÏûÖÎ†• ÌïÑÎìúÏùò max ÏÜçÏÑ± ÏÑ§Ï†ï
            startEl.max    = maxIso;
            completeEl.max = maxIso;

            // Ïù¥ÎØ∏ ÏÑ†ÌÉùÎêú Í∞íÏù¥ maxÎ•º ÎÑòÏóàÏúºÎ©¥ Î≥¥Ï†ï
            if (startEl.value && startEl.value > maxIso) {
                startEl.value = maxIso;
                alert('‚ö†Ô∏è Î∞úÏÉùÏãúÍ∞ÑÏùÄ ÌòÑÏû¨ ÏãúÍ∞ÅÎ∂ÄÌÑ∞ 24ÏãúÍ∞Ñ Ïù¥ÎÇ¥Ïó¨Ïïº Ìï©ÎãàÎã§.');
            }
            if (completeEl.value && completeEl.value > maxIso) {
                completeEl.value = maxIso;
                alert('‚ö†Ô∏è Ï°∞ÏπòÏôÑÎ£å ÏãúÍ∞ÑÏùÄ ÌòÑÏû¨ ÏãúÍ∞ÅÎ∂ÄÌÑ∞ 24ÏãúÍ∞Ñ Ïù¥ÎÇ¥Ïó¨Ïïº Ìï©ÎãàÎã§.');
            }
        }

        // 4) ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú, Î∞úÏÉùÏãúÍ∞Ñ Î≥ÄÍ≤Ω ÏãúÎßàÎã§ max Í∞±Ïã†
        window.addEventListener('load', () => {
            updateMaxConstraints();
            // Ïù¥ÎØ∏ ÏÑ§Ï†ïÌï¥Îëî min Ï†úÏïΩÎèÑ Ìïú Î≤à ÎèôÍ∏∞Ìôî
            completeEl.min = startEl.value;
            });
        startEl.addEventListener('change', () => {
            // min, max Îëò Îã§ Í∞±Ïã†
            completeEl.min = startEl.value;
            updateMaxConstraints();
            });
        completeEl.addEventListener('change', () => {
            updateMaxConstraints();
            // min Í≤ÄÏÇ¨: Î∞úÏÉùÏãúÍ∞Ñ Ïù¥Ï†ÑÏù¥Î©¥ Î≥¥Ï†ï
            if (completeEl.value < startEl.value) {
                completeEl.value = startEl.value;
                alert('‚ö†Ô∏è Ï°∞ÏπòÏôÑÎ£å ÏãúÍ∞ÑÏùÄ Î∞úÏÉùÏãúÍ∞Ñ Ïù¥ÌõÑÏó¨Ïïº Ìï©ÎãàÎã§.');
            }
        });

        
        // ÌòÑÏû¨ ÏãúÍ∞Ñ ÏÑ§Ï†ï Ìï®Ïàò
        function setCurrentDateTime(elementId) {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            const dateTimeValue = `${year}-${month}-${day}T${hours}:${minutes}`;
            document.getElementById(elementId).value = dateTimeValue;
        }
        
        // ÌÉ≠ Ï†ÑÌôò Ìï®Ïàò
        function switchTab(formId) {
            // Î™®Îì† ÌÉ≠Í≥º Ìèº ÎπÑÌôúÏÑ±Ìôî
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.form').forEach(form => {
                form.classList.remove('active');
            });
            
            // ÏÑ†ÌÉùÎêú ÌÉ≠Í≥º Ìèº ÌôúÏÑ±Ìôî
            if (formId === 'parameterForm') {
                document.querySelectorAll('.tab')[0].classList.add('active');
                document.getElementById('parameterForm').classList.add('active');
            } else {
                document.querySelectorAll('.tab')[1].classList.add('active');
                document.getElementById('troubleForm').classList.add('active');
            }
            
            // Í≤∞Í≥º Ïà®Í∏∞Í∏∞
            document.getElementById('result').style.display = 'none';
        }
        
        // ÎÇ†Ïßú ÌòïÏãùÌôî Ìï®Ïàò
        function formatDateTime(dateTimeStr) {
            if (!dateTimeStr) return '';
            
            const date = new Date(dateTimeStr);
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const hours = date.getHours();
            const minutes = String(date.getMinutes()).padStart(2, '0');
            
            const ampm = hours >= 12 ? 'Ïò§ÌõÑ' : 'Ïò§Ï†Ñ';
            const hour12 = hours % 12 || 12;
            
            return `${year}ÎÖÑ ${month}Ïõî ${day}Ïùº ${ampm} ${hour12}:${minutes}`;
        }
        
        // ÌååÎùºÎØ∏ÌÑ∞ Î≥ÄÍ≤Ω ÏñëÏãù ÏÉùÏÑ± Ìï®Ïàò
        function generateParameterText() {
            const site = document.getElementById('para-site').value;
            const machine = document.getElementById('para-machine').value;
            const process = document.getElementById('para-process').value;
            const unit = document.getElementById('para-unit').value;
            const assy = document.getElementById('para-assy').value;
            const time = formatDateTime(document.getElementById('para-time').value);
            const parameter = document.getElementById('para-parameter').value;
            const before = document.getElementById('para-before').value;
            const after = document.getElementById('para-after').value;
            const worker = document.getElementById('para-worker').value;
            const reason = document.getElementById('para-reason').value;
            
            let text = `‚ô£ÌååÎùºÎØ∏ÌÑ∞, IP Î≥ÄÍ≤Ω Í≥µÏú†\n`;
            text += `Ï¢ÖÎ•ò: ÌååÎùºÎØ∏ÌÑ∞ Î≥ÄÍ≤Ω\n`;
            text += `0. Site : ${site}\n`;
            text += `1. Ìò∏Í∏∞ : ${machine}\n`;
            text += `2-1. Machine : ${process}\n`;
            text += `2-2. Unit : ${unit}\n`;
            text += `2-3. Assy' : ${assy}\n`;
            text += `3. Î≥ÄÍ≤ΩÏãúÍ∞Ñ : ${time}\n`;
            text += `4. Î≥ÄÍ≤ΩÏûê : ${worker}\n`;
            text += `5. Î≥ÄÍ≤ΩPara : ${parameter}\n`;
            text += `6. Ïù¥Ï†ÑÍ∞í : ${before}\n`;
            text += `7. Î≥ÄÍ≤ΩÍ∞í : ${after}\n`;
            text += `8. Î≥ÄÍ≤ΩÏÇ¨Ïú† : ${reason}`;
            
            // Í≤∞Í≥º ÌëúÏãú
            document.getElementById('resultText').innerText = text;
            document.getElementById('result').style.display = 'block';
        }
        
        // Î∂ÄÎèôÎÇ¥Ïó≠ ÏñëÏãù ÏÉùÏÑ± Ìï®Ïàò
        function generateTroubleText() {
            const type = document.getElementById('trouble-type').value;
            const site = document.getElementById('trouble-site').value;
            const machine = document.getElementById('trouble-machine').value;
            const process = document.getElementById('trouble-process').value;
            const unit = document.getElementById('trouble-unit').value;
            const assy = document.getElementById('trouble-assy').value;
            const time = formatDateTime(document.getElementById('trouble-time').value);
            const complete = formatDateTime(document.getElementById('trouble-complete').value);
            const worker = document.getElementById('trouble-worker').value;
            const problem = document.getElementById('trouble-problem').value;
            const reason = document.getElementById('trouble-reason').value;
            const action = document.getElementById('trouble-action').value;
            
            let text = `[Î∂ÄÎèô&ÏûëÏóÖ Í≥µÏú†]\n`;
            text += `Ï¢ÖÎ•ò: ${type}\n`;
            text += `0. Site : ${site}\n`;
            text += `1. Ìò∏Í∏∞ : ${machine}\n`;
            text += `2-1. Machine : ${process}\n`;
            text += `2-2. Unit : ${unit}\n`;
            text += `2-3. Assy' : ${assy}\n`;
            text += `3-1. Î∞úÏÉùÏãúÍ∞Ñ : ${time}\n`;
            text += `3-2. Ï°∞ÏπòÏôÑÎ£å : ${complete}\n`;
            text += `4. ÏûëÏóÖÏûê : ${worker}\n`;
            text += `5. ÌòÑÏÉÅ : ${problem}\n`;
            text += `6. ÏõêÏù∏ : ${reason}\n`;
            text += `7. Ï°∞Ïπò : ${action}`;
            
            // Í≤∞Í≥º ÌëúÏãú
            document.getElementById('resultText').innerText = text;
            document.getElementById('result').style.display = 'block';
        }
        
        // ÌÖçÏä§Ìä∏ Î≥µÏÇ¨ Ìï®Ïàò
        function copyText() {
            const text = document.getElementById('resultText').innerText;
            navigator.clipboard.writeText(text)
                .then(() => {
                    alert('ÌÖçÏä§Ìä∏Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.');
                })
                .catch(err => {
                    console.error('ÌÅ¥Î¶ΩÎ≥¥Îìú Î≥µÏÇ¨ Ïã§Ìå®:', err);
                    alert('ÌÅ¥Î¶ΩÎ≥¥Îìú Î≥µÏÇ¨Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. ÏàòÎèôÏúºÎ°ú ÌÖçÏä§Ìä∏Î•º ÏÑ†ÌÉùÌïòÏó¨ Î≥µÏÇ¨ÌïòÏÑ∏Ïöî.');
                });
        }

        function copyTextSafe(text) {
            // 1) ÏµúÏã† API ÏãúÎèÑ
            if (navigator.clipboard && window.isSecureContext) {
                return navigator.clipboard.writeText(text).then(() => {
                    alert("‚úÖ ÌÖçÏä§Ìä∏Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.");
                }).catch(err => {
                    console.warn("clipboard.writeText Ïã§Ìå®:", err);
                    fallbackCopy(text);
                });
            } else {
                // 2) Î≥¥ÏïàÌôòÍ≤Ω ÏïÑÎãò ‚Üí Ìè¥Î∞±
                fallbackCopy(text);
            }
        }

        function fallbackCopy(text) {
            const textarea = document.createElement("textarea");
            textarea.value = text;
            textarea.style.position = "fixed";  // ÌôîÎ©¥Ïóê Ïïà Î≥¥Ïù¥Í≤å
            textarea.style.opacity = "0";
            document.body.appendChild(textarea);
            textarea.focus();
            textarea.select();

            try {
                document.execCommand("copy");
                alert("‚úÖ ÌÖçÏä§Ìä∏Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§. (Ìè¥Î∞±)");
            } catch (err) {
                console.error("execCommand copy Ïã§Ìå®:", err);
                alert("‚ö†Ô∏è Î≥µÏÇ¨Í∞Ä ÏßÄÏõêÎêòÏßÄ ÏïäÎäî ÌôòÍ≤ΩÏûÖÎãàÎã§. ÏßÅÏ†ë ÏÑ†ÌÉùÌï¥ÏÑú Î≥µÏÇ¨Ìï¥Ï£ºÏÑ∏Ïöî.");
            } finally {
                document.body.removeChild(textarea);
            }
        }
        
        // Í≥µÏú†ÌïòÍ∏∞ Ìï®Ïàò
        function shareContent() {
            const text = document.getElementById('resultText').innerText;
            const title = 'ESMI2 JF2 Í≥µÏú† ÎÇ¥Ïö©';
            
            // Web Share API ÏßÄÏõê ÌôïÏù∏
            if (navigator.share) {
                navigator.share({
                    title: title,
                    text: text
                })
                .then(() => {
                    console.log('Í≥µÏú† ÏÑ±Í≥µ');
                })
                .catch((error) => {
                    console.log('Í≥µÏú† Ïã§Ìå®:', error);
                    // Í≥µÏú† Ïã§Ìå® Ïãú ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨
                    fallbackToCopy(text);
                });
            } else {
                // Web Share APIÎ•º ÏßÄÏõêÌïòÏßÄ ÏïäÎäî Í≤ΩÏö∞ ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨
                fallbackToCopy(text);
            }
        }

        async function shareContentWithRetry(maxRetries = 2) {
            const text = document.getElementById("resultText").innerText;
            const title = "PRI L&S Í≥µÏú† ÎÇ¥Ïö©";

            for (let attempt = 1; attempt <= maxRetries; attempt++) {
                try {
                    if (navigator.share) {
                        await navigator.share({ title: title, text: text });
                        console.log(`‚úÖ Í≥µÏú† ÏÑ±Í≥µ (ÏãúÎèÑ ${attempt})`);
                        return; // ÏÑ±Í≥µ Ïãú Ìï®Ïàò Ï¢ÖÎ£å
                    } else {
                        throw new Error("Web Share API ÎØ∏ÏßÄÏõê");
                    }
                } catch (err) {
                    console.warn(`‚ö†Ô∏è Í≥µÏú† Ïã§Ìå® (ÏãúÎèÑ ${attempt}):`, err);

                    if (attempt === maxRetries) {
                        // ÎßàÏßÄÎßâ Ïã§Ìå® ‚Üí ÌÅ¥Î¶ΩÎ≥¥Îìú Î≥µÏÇ¨ Ìè¥Î∞±
                        copyTextSafe(text);
                        alert("‚ö†Ô∏è Í≥µÏú†Í∞Ä Î∞òÎ≥µ Ïã§Ìå®ÌïòÏó¨ ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÌñàÏäµÎãàÎã§.");
                    }
                }
            }
        }
        
        // ÌÅ¥Î¶ΩÎ≥¥Îìú Î≥µÏÇ¨ ÎåÄÏ≤¥ Î∞©Î≤ï
        function fallbackToCopy(text) {
            navigator.clipboard.writeText(text)
                .then(() => {
                    alert('ÌÖçÏä§Ìä∏Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.');
                })
                .catch(err => {
                    console.error('ÌÅ¥Î¶ΩÎ≥¥Îìú Î≥µÏÇ¨ Ïã§Ìå®:', err);
                    alert('ÌÅ¥Î¶ΩÎ≥¥Îìú Î≥µÏÇ¨Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§. ÏàòÎèôÏúºÎ°ú ÌÖçÏä§Ìä∏Î•º ÏÑ†ÌÉùÌïòÏó¨ Î≥µÏÇ¨ÌïòÏÑ∏Ïöî.');
                });
        }

    </script>




<script>
/* ================= LANGUAGE SYSTEM (UI ONLY) ================= */
const translations = {
  en: {
    title: "PRI L&S Para Change History Floating History Form",
    subtitle: "Enter Parameter Change History and Floating & Work History Form",
    tab_para: "Para/IP Change Sharing",
    tab_trouble: "Share floating history",
    site: "0. Site :",
    volume: "1. Volume:",
    type: "Types:",
    create: "Create a form"
  },
  kr: {
    title: "PRI L&S Para Change History Floating History Form",
    subtitle: "ÌååÎùºÎØ∏ÌÑ∞ Î≥ÄÍ≤Ω Î∞è Î∂ÄÎèô/ÏûëÏóÖ ÎÇ¥Ïó≠ ÏûÖÎ†•",
    tab_para: "Para/IP Î≥ÄÍ≤Ω Í≥µÏú†",
    tab_trouble: "Î∂ÄÎèô ÎÇ¥Ïó≠ Í≥µÏú†",
    site: "0. Site :",
    volume: "1. Ìò∏Í∏∞:",
    type: "Ï¢ÖÎ•ò:",
    create: "ÏñëÏãù ÏÉùÏÑ±"
  }
};

function setLang(lang){
  document.querySelectorAll("[data-i18n]").forEach(el=>{
    const key = el.getAttribute("data-i18n");
    if(translations[lang][key]) el.innerText = translations[lang][key];
  });
  document.getElementById("btn-en").style.background = lang==="en" ? "#4a4a4a":"#ddd";
  document.getElementById("btn-en").style.color = lang==="en" ? "white":"black";
  document.getElementById("btn-kr").style.background = lang==="kr" ? "#4a4a4a":"#ddd";
  document.getElementById("btn-kr").style.color = lang==="kr" ? "white":"black";
}
</script>

</body>
